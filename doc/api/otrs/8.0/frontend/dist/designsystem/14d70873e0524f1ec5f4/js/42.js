(window.webpackJsonp=window.webpackJsonp||[]).push([[42,460],{"45qa":function(t,e,a){"use strict";var n=a("7kBL");a.n(n).a},"7kBL":function(t,e,a){},FYTe:function(t,e,a){t.exports=a.p+"img/chaticon.d1c2d27.png"},cFE3:function(t,e,a){"use strict";a.r(e);a("2Tod"),a("ABKx"),a("GkPX");var n=a("OvAC"),s=a.n(n);a("W1QL"),a("K/PF"),a("t91x"),a("75LO"),a("e2Kn");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var i={name:"ChatCreate",components:{FormInput:function(){return a.e(17).then(a.bind(null,"CJfq"))},FormSelect:function(){return Promise.all([a.e(0),a.e(1),a.e(26)]).then(a.bind(null,"cDBQ"))},FormButton:function(){return Promise.all([a.e(3),a.e(11)]).then(a.bind(null,"dphA"))},ChatFooter:function(){return a.e(88).then(a.bind(null,"4L3h"))}},props:{publicUserId:{type:String},authenticated:{type:Boolean},allowChatChannels:{type:Boolean},defaultChatChannelId:{type:Number},showBackButton:{type:Boolean},primaryColor:{type:String},createChatTitle:{type:String,default:"Do you have any questions? Chat with us!"},noAvailableAgentsTitle:{type:String,default:"It looks like no one is available at the moment. Please try again later."},createTicketText:{type:String,default:"Or, create a ticket instead."},createTicketButtonText:{type:String,default:"Create Ticket"},publicUserNameText:{type:String,default:"Please enter your name."},publicUserNamePlaceholder:{type:String,default:"John Doe"},chatChannelsLabelText:{type:String,default:"Please select a channel."},writeMessageText:{type:String},noAvailableAgentsDescription:{type:String},noAvailableAgentsButtonText:{type:String},noAvailableAgentsButtonLink:{type:String}},data:function(){return{publicUserName:null,messageText:null,sendingActive:1,chatChannelId:this.defaultChatChannelId||null,chatChannels:[],availableChannelsLoaded:!1}},computed:{isValid:function(){return!(!this.authenticated&&!this.publicUserName)&&(!!this.messageText&&!(this.allowChatChannels&&this.chatChannels.length&&!this.chatChannelId))},isSendingActive:function(){return 0!==this.sendingActive}},watch:{authenticated:function(){this.allowChatChannels&&this.getAvailableChannels()}},mounted:function(){this.allowChatChannels&&this.getAvailableChannels()},methods:{getAvailableChannels:function(){var t=this,e="public/chat/available-channels";this.authenticated||(e="public/chat/".concat(this.publicUserId,"/available-channels")),this.clientSendRequest({Path:e,Method:"get"}).then(function(e){t.chatChannels=t.chatChannelNormalizer(e.Body),t.defaultChatChannelId||1!==t.chatChannels.length||(t.chatChannelId=t.chatChannels[0].id,t.$test.setFlag("Chat::AvailableChannels::SingleChoice")),t.availableChannelsLoaded=!0,t.$nextTick(function(){t.$test.setFlag("Chat::AvailableChannels::Fetch")})}).catch(function(e){t.$log.error(e),t.$bus.$emit("showToastMessage",{id:"availableChannelsMessage",heading:"Error Loading Chat Channels",text:"The chat channels could not be loaded. Please contact the administrator.",variant:"danger",persistent:!1})})},chatChannelNormalizer:function(t){var e=[];return Object.keys(t).forEach(function(a){e.push({id:t[a].ID,label:t[a].Name})}),e},createChatRequest:function(){var t=this,e="public/chat/request-create";this.authenticated||(e="public/chat/".concat(this.publicUserId,"/request-create"));var a={};this.publicUserName&&(a.Name=this.publicUserName);var n={};this.chatChannelId&&(n.ChatChannelID=this.chatChannelId),this.clientSendRequest({Path:e,Method:"post",Body:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach(function(e){s()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({Message:this.messageText},a,{},n)}).then(function(e){t.$emit("created",e.Body.ChatID)}).catch(function(e){t.$log.error(e),t.$bus.$emit("showToastMessage",{id:"chatRequestMessage",heading:"Error Creating Chat Request",text:"The new chat request could not be created. Please contact the administrator.",variant:"danger",persistent:!1})})},back:function(){this.$emit("back")},goToTicketCreate:function(){"TicketCreate"!==this.$route.name&&this.$router.push({name:"TicketCreate"}),this.close()},close:function(){this.$emit("close")}}},r=(a("45qa"),a("psIG")),c=Object(r.a)(i,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-col",{staticClass:"px-0 mb-3 shadow Chat--WhiteBackground",attrs:{md:"12"}},[t.showBackButton?n("b-col",{staticClass:"py-2 Chat__Head Chat--WhiteBackground",attrs:{cols:"12"}},[n("CommonLink",{staticClass:"Chat__Icon",style:{color:t.primaryColor?t.primaryColor+" !important":null},on:{click:t.back}},[n("CommonIcon",{attrs:{icon:"arrow-left-1"}})],1)],1):t._e(),t._v(" "),t.allowChatChannels&&!t.chatChannels.length&&t.availableChannelsLoaded?[n("b-col",{staticClass:"mh-100 py-3 Chat__Content",attrs:{md:"12"}},[n("b-row",[n("b-col",{staticClass:"text-center",attrs:{md:"12"}},[n("div",{staticClass:"my-2"},[n("img",{attrs:{src:a("FYTe"),alt:""}})])])],1),t._v(" "),n("b-row",[n("b-col",{staticClass:"mb-3 text-center",attrs:{md:"12"}},[n("h2",[t._v(t._s(t._f("translate")(t.noAvailableAgentsTitle)))])])],1),t._v(" "),t.authenticated?n("b-row",[n("b-col",{staticClass:"text-center",attrs:{md:"12"}},[n("p",[t._v(t._s(t._f("translate")(t.createTicketText)))]),t._v(" "),n("FormButton",{attrs:{variant:"primary"},on:{click:t.goToTicketCreate}},[t._v("\n                        "+t._s(t._f("translate")(t.createTicketButtonText))+"\n                    ")])],1)],1):t._e(),t._v(" "),t.noAvailableAgentsButtonText&&t.noAvailableAgentsButtonLink?n("b-row",[n("b-col",{staticClass:"mb-3 text-center",attrs:{md:"12"}},[t.authenticated?n("br"):t._e(),t._v(" "),n("p",[t._v(t._s(t._f("translate")(t.noAvailableAgentsDescription)))]),t._v(" "),n("FormButton",{attrs:{variant:"primary","is-external":!0,link:t.noAvailableAgentsButtonLink}},[t._v("\n                        "+t._s(t._f("translate")(t.noAvailableAgentsButtonText))+"\n                    ")])],1)],1):t._e()],1)]:t.availableChannelsLoaded?[n("b-col",{staticClass:"mh-100 py-3 Chat__Content",attrs:{md:"12"}},[n("b-row",[n("b-col",{staticClass:"text-center",attrs:{md:"12"}},[n("div",{staticClass:"my-2"},[n("img",{attrs:{src:a("FYTe"),alt:""}})])])],1),t._v(" "),n("b-row",[n("b-col",{staticClass:"mb-3 text-center",attrs:{md:"12"}},[n("h2",[t._v(t._s(t._f("translate")(t.createChatTitle)))])])],1),t._v(" "),t.authenticated?t._e():n("b-row",[n("b-col",{staticClass:"text-center",attrs:{md:"12"}},[n("FormInput",{attrs:{label:t._f("translate")(t.publicUserNameText),placeholder:t._f("translate")(t.publicUserNamePlaceholder),required:""},model:{value:t.publicUserName,callback:function(e){t.publicUserName=e},expression:"publicUserName"}})],1)],1),t._v(" "),t.allowChatChannels&&t.chatChannels.length>1&&!t.defaultChatChannelId?n("b-row",[n("b-col",{staticClass:"text-center",attrs:{md:"12"}},[n("FormSelect",{attrs:{label:t._f("translate")(t.chatChannelsLabelText),options:t.chatChannels,required:""},model:{value:t.chatChannelId,callback:function(e){t.chatChannelId=e},expression:"chatChannelId"}})],1)],1):t._e()],1),t._v(" "),n("ChatFooter",{attrs:{"is-valid":t.isValid,"is-sending-active":t.isSendingActive,"primary-color":t.primaryColor,"write-message-text":t.writeMessageText},on:{send:t.createChatRequest},model:{value:t.messageText,callback:function(e){t.messageText=e},expression:"messageText"}})]:t._e()],2)},[],!1,null,null,null);e.default=c.exports}}]);