<html><head>
<!-- otrs.github.io -->
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../../../../../documentation.css">
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../documentation.js"></script>
<link rel="icon" type="image/png" sizes="32x32" href="../../../../../../images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../../../images/favicon-16x16.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script>
$(document).ready(function() {

    // Hint languages to prevent false matches (php for example).
    hljs.configure({
        languages: ['perl', 'javascript', 'xml', 'html', 'css', 'json', 'yaml']
    });

    // programlistings in manuals
    $('pre.programlisting').each(function(i, block) {
        hljs.highlightBlock(block);
    });
    // code snippets in Perl API docs
    $('.pod pre').addClass('perl').each(function(i, block) {
        hljs.highlightBlock(block);
    });
});</script>
<!-- otrs.github.io -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>数据库动态字段</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="OTRS商业解决方案™ 6手册"><link rel="up" href="otrs-business-solution-features.html" title="Chapter 3. OTRS商业解决方案™ 的特色功能"><link rel="prev" href="dynamicfield-contact-with-data.html" title="联系信息动态字段"><link rel="next" href="dynamicfield-webservice.html" title="WEB服务动态字段"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><span class="emphasis"><em>数据库</em></span>动态字段</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dynamicfield-contact-with-data.html">Prev</a> </td><th width="60%" align="center">Chapter 3. <span class="bold"><strong>OTRS商业解决方案</strong></span>™ 的特色功能</th><td width="20%" align="right"> <a accesskey="n" href="dynamicfield-webservice.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="dynamicfield-database"></a><span class="emphasis"><em>数据库</em></span>动态字段</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.3">描述</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4">配置</a></span></dt><dd><dl><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4.3">添加一个<span class="emphasis"><em>数据库</em></span>动态字段</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4.4">配置外部数据源</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4.5">配置使用屏幕</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4.6">存储历史数据</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.4.7">系统配置设置</a></span></dt></dl></dd><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.5">用法</a></span></dt><dd><dl><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.5.3">搜索和保存数据集 - 自动完成</a></span></dt><dt><span class="section"><a href="dynamicfield-database.html#id-1.4.4.5.4">搜索和保存数据集 - 详细信息搜索</a></span></dt></dl></dd></dl></div><p>
        此功能实现了<span class="emphasis"><em>数据库</em></span>类型的动态字段。
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="id-1.4.4.3"></a>描述</h3></div></div></div><p>
            此功能实现了通用动态字段类型，可以从外部数据库收集数据。 可以使用额外的掩码来搜索和过滤这些连接的数据集。
        </p><p>
            发现和标记的相关数据集可以通过动态字段保存到特定的工单。
        </p><p>
            <span class="emphasis"><em>数据库</em></span>动态字段可以按创建默认的动态字段相同的方式创建。
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="id-1.4.4.4"></a>配置</h3></div></div></div><p>
            可以按以下的配置选项清单来使用此功能。
        </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.4.3"></a>添加一个<span class="emphasis"><em>数据库</em></span>动态字段</h4></div></div></div><p>
                此功能实现了一个配置界面，用于创建<span class="emphasis"><em>数据库</em></span>类型的动态字段。
            </p><p>
                <span class="emphasis"><em>数据库</em></span>动态字段可以按创建默认的动态字段相同的方式创建。转到<span class="emphasis"><em>系统管理 → 工单设置 →
动态字段</em></span> 视图。在这个遮罩屏幕中，您可以从左侧的工单下拉框中选择<span class="emphasis"><em>数据库</em></span>字段。
目前，无法在信件上下文中使用<span class="emphasis"><em>数据库</em></span>动态字段。
            </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                        配置 <span class="emphasis"><em>通用 - 名称</em></span>：
                    </p><p>
                        <span class="emphasis"><em>数据库</em></span>类型的动态字段也需要一个唯一的名称，就像其他动态字段一样。 此名称必须仅包含字母数字值。
此名称将用于字段的内部处理，但不会显示。
                    </p></li><li class="listitem"><p>
                        配置 <span class="emphasis"><em>通用 - 标签</em></span>：
                    </p><p>
                        可以单独设置标签，且标签可以包含空格等。它将被用作不同视图中的字段标签。
                    </p></li><li class="listitem"><p>
                        配置 <span class="emphasis"><em>通用 - 字段顺序</em></span>：
                    </p><p>
                        字段顺序允许管理员更改创建的动态字段的顺序。 如果改变了这个配置，将调整常规的字段顺序，其他动态字段将被往后移动一个位置。
                    </p></li><li class="listitem"><p>
                        配置 <span class="emphasis"><em>通用 - 有效性</em></span>：
                    </p><p>
                        要在配置的OTRS视图中使用动态字段，必须将其设置为有效。 如果该字段设置为<span class="emphasis"><em>
无效</em></span>，则它将从所有已配置的视图中消失，但不会丢失任何数据。
                    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.4.4"></a>配置外部数据源</h4></div></div></div><p>
                在搜索外部数据库并通过动态字段将结果保存在工单之前，必须将凭据存储在动态字段的配置中。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.4.4.3.1"></a><p class="title"><b>Figure 3.17. 数据库动态字段管理屏幕</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/AdminOverview.png" alt="数据库动态字段管理屏幕"></div></div></div></div><p><br class="figure-break">
            </p><p>
                类型：可以在此处选择所需数据库的类型。 该字段支持默认的OTRS数据库类型：MySQL、Oracle、PostgreSQL或MSSQL。
            </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                        <span class="emphasis"><em>SID</em></span>：此选项仅适用于Oracle连接，并将自动显示或隐藏。 在此选项中，您必须输入Oracle连接的SID。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Driver</em></span>：此选项仅适用于ODBC连接，并将自动显示或隐藏。
在此选项中，您必须在主机系统中输入先前配置的ODBC驱动程序才能连接到所需的MSSQL数据库。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Server</em></span>：数据库主机（主机名或IP地址）。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Port</em></span>：数据库服务器的端口。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Database</em></span>：定义DBMS的所需目标数据库。 该数据库将用于查询。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Table /View</em></span>：此表或视图将用于查询。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>User</em></span>：数据库连接的用户名。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Password</em></span>：数据库连接的用户密码。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Identifier</em></span>：此选择框将通过<span class="emphasis"><em>可能的值（见下面的描述）</em></span>自动填充。
该字段表示将存储在动态字段中的值。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Multiselect</em></span>：如果选择此字段，则可以将多个值存储到动态字段中。 这些值将以逗号分隔存储。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>CacheTTL</em></span>：此值定义数据库缓存的有效期（以秒为单位）。
在此期间内，将通过缓存（本地文件系统）响应对数据库的相等查询，而不是再次查询数据库。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Searchprefix</em></span>：使用自动完成功能搜索数据库时，此值将放在每个搜索词的前面。 也支持通配符。
在详细信息搜索期间将忽略搜索前缀，但仍可以在这些掩码中使用通配符。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Searchsuffix</em></span>：使用自动完成功能搜索数据库时，此值将放在每个搜索词的末尾。 也支持通配符。
在详细信息搜索期间将忽略搜索后缀，但仍可以在这些掩码中使用通配符。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Result Limit</em></span>：输入的整数值定义数据库搜索期间允许的最大结果量。
这包括自动完成搜索以及详细信息搜索。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Case Sensitive</em></span>：如果选择此字段，搜索将区分大小写。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Possible values</em></span>：如前所述，可能的值将自动填充标识符字段，该字段定义将存储在动态字段中的值。
可以根据需要创建可能的值（或者至少与数据库表一样多的表列）。
可能的值定义要搜索的数据库列。可以设置列名、字段应具有的描述（标签）、所需的数据类型以及字段是否为搜索字段或列表字段。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Name</em></span>：将通过数据库查询请求的数据库列的确切名称。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Description</em></span>：将在详细信息搜索中显示的字段标签。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Datatype</em></span>：将存储在动态字段中的数据类型。 可能的值：TEXT、INTEGER或DATE。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Filter</em></span>：使用过滤器字段，可以选择工单属性或动态字段作为相关列的过滤器。
如果动态字段绑定到相关工单，则属性将用于过滤机制，否则将忽略过滤器。
如果将过滤器配置为表列，则仅显示与搜索项匹配的搜索结果以及与配置列完全相关的工单属性。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Searchfield</em></span>：指示是否应在搜索请求中包含字段。
                    </p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Listfield</em></span>：指示是否应在结果中显示字段。
                    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.4.5"></a>配置使用屏幕</h4></div></div></div><p>
                必须为要显示的几个遮罩屏幕激活类型为<span class="emphasis"><em>数据库</em></span>的动态字段，就像其他类型的动态字段一样。
            </p><p>
                这可以通过<span class="emphasis"><em> 系统管理 → 系统管理 → 系统配置 </em></span>并在左侧选择<span class="emphasis"><em> 工单
</em></span>来完成。
            </p><p>
                对于要显示<span class="emphasis"><em>数据库</em></span>类型的动态字段的每个界面区域（前端），管理员必须配置它以满足其需要。 示例：
                </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                            <code class="literal">Frontend::Agent::Ticket::ViewZoom</code> 配置工单详情视图。
                        </p></li><li class="listitem"><p>
                            <code class="literal">Frontend::Agent::Ticket::ViewPhoneNew</code>配置新建电话工单。
                        </p></li><li class="listitem"><p>
                            <code class="literal">Frontend::Agent::Ticket::ViewEmailNew</code> 配置新建邮件工单。
                        </p></li><li class="listitem"><p>
                            在每个视图配置中都有一个名为<code class="literal">Ticket::Frontend::AgentTicket*###DynamicField</code>的条目。
此配置定义应在此视图中显示的动态字段。 要添加动态字段，必须在<span class="emphasis"><em>键</em></span>字段中填写字段的内部名称。
字段<span class="emphasis"><em>值</em></span>可以取值0（取消激活）、1（激活）和2（激活且必需）。
                        </p></li></ul></div><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.4.6"></a>存储历史数据</h4></div></div></div><p>
                此功能提供存储历史数据的功能。 为此，需要激活和设置系统配置选项，如下面的屏幕截图中所示：
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.4.6.3.1"></a><p class="title"><b>Figure 3.18. 数据库动态字段 - 历史数据设置</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/SysConfigStoreHistoricalData.png" alt="数据库动态字段 - 历史数据设置"></div></div></div></div><p><br class="figure-break">
            </p><p>
                在<code class="literal"> SourceDynamicField
</code>的配置选项中，需要填写已创建的（数据库）动态字段名称，该名称将用于收集历史数据。 在相关选项<code class="literal">
TargetDynamicField
</code>中，字段<span class="emphasis"><em>键</em></span>必须填充连接的外部数据库的表列，这些列将被读出。
对于每列，必须在<span class="emphasis"><em> 内容 </em></span>字段中配置相关的目标动态字段。 收集的数据将保存在这些动态字段中。
            </p><p>
                如果配置已准备就绪并且激活，则配置的字段将从外部数据库读取，因为源字段通过配置的掩码获取新值。
数据将通过事件模块通过存储的标识符进行搜索，并将找到的值存储在目标动态字段中。
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.4.7"></a>系统配置设置</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">AutoComplete::Agent###DynamicFieldDatabaseSearch</code></span></dt><dd><p>Group: <code class="literal">Framework</code>, Subgroup:
<code class="literal">Frontend::Agent</code></p><p>
                            定义自动完成功能的配置选项。
                        </p></dd><dt><span class="term"><code class="literal">Ticket::EventModulePost###950-StoreHistoricalData</code></span></dt><dd><p>组：<code class="literal">Ticket</code>, 子组：<code class="literal">Core::Ticket</code></p><p>
                            更新动态字段, 如果配置了就会更新它。
                        </p></dd><dt><span class="term"><code class="literal">DynamicFieldDatabase::StoreHistoricalData###1-SourceDynamicField1</code></span></dt><dd><p>组：<code class="literal">OTRSBusiness</code>, 子组：<code class="literal">Core</code></p><p>
                            定义存储历史数据的源动态字段。
                        </p></dd><dt><span class="term"><code class="literal">DynamicFieldDatabase::StoreHistoricalData###2-TargetDynamicFields1</code></span></dt><dd><p>组：<code class="literal">OTRSBusiness</code>, 子组：<code class="literal">Core</code></p><p>
                            定义存储历史数据的目标动态字段。
                        </p></dd><dt><span class="term"><code class="literal">DynamicFieldDatabase::StoreHistoricalData###3-SourceDynamicField2</code></span></dt><dd><p>组：<code class="literal">OTRSBusiness</code>, 子组：<code class="literal">Core</code></p><p>
                            定义存储历史数据的源动态字段。
                        </p></dd><dt><span class="term"><code class="literal">DynamicFieldDatabase::StoreHistoricalData###4-TargetDynamicFields2</code></span></dt><dd><p>组：<code class="literal">OTRSBusiness</code>, 子组：<code class="literal">Core</code></p><p>
                            定义存储历史数据的目标动态字段。
                        </p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="id-1.4.4.5"></a>用法</h3></div></div></div><p>
            数据库动态字段的示例性用法如下：
        </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.5.3"></a>搜索和保存数据集 - 自动完成</h4></div></div></div><p>
                在众所周知的遮罩窗口（如<code class="literal"> ViewPhoneNew </code>、<code class="literal"> ViewEmailNew
</code>）中激活创建的动态字段后，将出现一个带有名称的新文本字段，动态字段位于配置中。
在此字段中，可以输入搜索词，从而对所有已配置的数据库字段执行搜索。
否则，点击<span class="emphasis"><em>详细信息搜索</em></span>链接并开始详细信息搜索，其中显式选择要搜索的字段。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.5.3.3.1"></a><p class="title"><b>Figure 3.19. 数据库动态字段 - 测试字段</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/SearchFieldEmpty.png" alt="数据库动态字段 - 测试字段"></div></div></div></div><p><br class="figure-break">
            </p><p>
                由于搜索词被输入到文本字段中，因此将在配置的列上启动数据库搜索，结果将通过文本字段下方的自动完成显示。 搜索项越精确，结果就越精确（结果条目越少）。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.5.3.5.1"></a><p class="title"><b>Figure 3.20. 数据库动态字段 - 自动完成功能</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/SearchFieldAutoCompletion.png" alt="数据库动态字段 - 自动完成功能"></div></div></div></div><p><br class="figure-break">
            </p><p>
                如果希望的值显示在结果中，则可以通过鼠标单击或通过键盘选择它，因此可以将其添加到动态字段结果中。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.5.3.7.1"></a><p class="title"><b>Figure 3.21. 数据库动态字段 - 选定条目</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/SearchFieldSelected.png" alt="数据库动态字段 - 选定条目"></div></div></div></div><p><br class="figure-break">
            </p><p>
                通过<span class="emphasis"><em> 详细 </em></span>链接可以访问一个弹出屏幕，其中提供了有关整个结果行的详细信息。 此信息包括行标题和数据。
此信息可用于获取有关（未配置的）其余列的概览或比较数据。
            </p><p>
                添加的结果条目可以通过减号按钮删除。
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="id-1.4.4.5.4"></a>搜索和保存数据集 - 详细信息搜索</h4></div></div></div><p>
                <span class="emphasis"><em>详细信息搜索</em></span>链接打开一个新的模式对话框以启动新的数据库搜索。 在此遮罩窗口中，可以显式选择要搜索的字段。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.5.4.3.1"></a><p class="title"><b>Figure 3.22. 数据库动态字段 - 详细信息搜索</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/DetailedSearchMask.png" alt="数据库动态字段 - 详细信息搜索"></div></div></div></div><p><br class="figure-break">
            </p><p>
                默认情况下，第一个可用字段已激活，但也可以删除可用字段或添加其他字段。 只有激活和填充的字段才会被考虑用于搜索。 每个字段都允许使用通配符“*”。
            </p><p>
                数据库搜索将通过<span class="emphasis"><em>开始搜索</em></span>按钮执行，结果将以表格形式显示。
如果搜索成功，将列出结果，并可通过鼠标点击选择其中一个条目。 之后，该值将添加到已保存值列表中。
            </p><p>
                </p><div class="figure"><a name="id-1.4.4.5.4.6.1"></a><p class="title"><b>Figure 3.23. 数据库动态字段 - 详细信息的搜索结果</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/dynamicfield-database/DetailedSearchResult.png" alt="数据库动态字段 - 详细信息的搜索结果"></div></div></div></div><p><br class="figure-break">
            </p><p>
                不管是使用自动完成还是详细信息搜索，每个结果值只能选择一次。 如果服务人员尝试多次选择一个值，则会显示相关的警告消息。
            </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dynamicfield-contact-with-data.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="otrs-business-solution-features.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="dynamicfield-webservice.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="emphasis"><em>联系信息</em></span>动态字段 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> <span class="emphasis"><em>WEB服务</em></span>动态字段</td></tr></table></div></body></html>
