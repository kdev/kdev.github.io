

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Layout &mdash; OTRS Administration Manual 7.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/otrs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="OTRS Group Services" href="../otrs-group-services.html" />
    <link rel="prev" title="Home Page" href="home-page.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
    
    
    <a href="https://doc.otrs.com/doc" class="icon fa-rocket DocumentationOverview"> OTRS Documentation</a>

    

          
            <a href="../index.html" class="icon icon-home"> OTRS Administration Manual
          

          
            
            <img src="../../_static/otrs-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ticket-settings.html">Ticket Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../communication-notifications.html">Communication &amp; Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-groups-roles.html">Users, Groups &amp; Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processes-automation.html">Processes &amp; Automation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../external-interface.html">External Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="customer-service-catalogue.html">Customer Service Catalogue</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-pages.html">Custom Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="home-page.html">Home Page</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Layout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#include-custom-scripts">Include Custom Scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web-analytics-example">Web Analytics Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../otrs-group-services.html">OTRS Group Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OTRS Administration Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../external-interface.html">External Interface</a> &raquo;</li>
        
      <li>Layout</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OTRS/doc-admin/blob/rel-7_0/content/external-interface/layout.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="layout">
<h1>Layout<a class="headerlink" href="#layout" title="Permalink to this headline">¶</a></h1>
<p>Use this screen to edit the layout displayed in external interface. The layout management screen is available in the <em>Layout</em> module of the <em>External Interface</em> group.</p>
<div class="figure" id="id1">
<img alt="Edit Layout Screen" src="../../_images/layout.png" />
<p class="caption"><span class="caption-text">Edit Layout Screen</span></p>
</div>
<p>A fresh OTRS installation already contains a default layout. In this screen all parameters can be changed.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure to save your changes when you finish. The new configuration will be immediately deployed.</p>
</div>
<dl class="docutils">
<dt>Logo</dt>
<dd><p class="first">The logo is a small image that is displayed in the top left corner of the external pages.</p>
<p class="last">To change the logo, click on the <em>Select image to upload</em> button, and select a new logo image. Recommended file format is PNG.</p>
</dd>
<dt>Favicon</dt>
<dd><p class="first">The <a class="reference external" href="https://en.wikipedia.org/wiki/Favicon">favorite icon</a> is an icon that is displayed in the URL bar of the web browser.</p>
<p class="last">To change the favorite icon, click on the <em>Select image to upload</em> button, and select a new icon. This is usually a 16×16 pixel image in PNG or ICO format.</p>
</dd>
<dt>Primary Color</dt>
<dd><p class="first">Primary color is the most important color of the external pages (see the preview screen).</p>
<p class="last">To change the primary color, just select a new color from the color palette. You can chose from the pre-selected colors or define other colors by choosing it from the color selector or typing the hexadecimal value. The new color will be displayed in the preview widget immediately.</p>
</dd>
<dt>Highlight Color</dt>
<dd><p class="first">Highlight color is the second color of the external pages using for status badges, links, etc.</p>
<p class="last">To change the highlight color, just select a new color from the color palette. You can chose from the pre-selected colors or define other colors by choosing it from the color selector or typing the hexadecimal value. The new color will be displayed in the preview widget immediately.</p>
</dd>
<dt>Default Avatar</dt>
<dd><p class="first">Will be used as the default avatar for all outgoing communication.</p>
<p class="last">To change the avatar, click on the <em>Select image to upload</em> button, and select a new avatar image.</p>
</dd>
<dt>Custom CSS</dt>
<dd><p class="first">Use this text area to add custom CSS to be applied in the external interface.</p>
<div class="last figure" id="id2">
<img alt="Custom CSS Widget" src="../../_images/layout-custom-css.png" />
<p class="caption"><span class="caption-text">Custom CSS Widget</span></p>
</div>
</dd>
</dl>
<div class="section" id="include-custom-scripts">
<h2>Include Custom Scripts<a class="headerlink" href="#include-custom-scripts" title="Permalink to this headline">¶</a></h2>
<p>External interface application has been built with security-first mindset in place. It contains several mechanisms to make sure that all code in the front end is provided directly by the OTRS framework.</p>
<p>In addition, a security standard called <a class="reference external" href="https://en.wikipedia.org/wiki/Content_Security_Policy">Content Security Policy</a> headers is now leveraged by the built-in web server. It serves as a last line of defense and in case some unexpected code still makes it to the client, it will make sure that the user’s browser simply refuses to run it.</p>
<p>However, a use-case still exists in which even a modern web application might still need to run some additional code, provided it is vetted and included by the administrators. One example could be an external integrated chat solution, but could also be an inline code snippet used for external web analytics.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Including custom scripts can be done in the <a class="reference internal" href="../administration/system-configuration.html"><span class="doc">System Configuration</span></a> with the following settings:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">ExternalFrontend::ExternalScripts</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ExternalFrontend::InlineScripts</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">WebApp::Server::AdditionalOrigins</span></code></li>
</ul>
</div>
<div class="section" id="web-analytics-example">
<h3>Web Analytics Example<a class="headerlink" href="#web-analytics-example" title="Permalink to this headline">¶</a></h3>
<p>In this example, we outline the steps to include custom scripts used by a web analytics provider in the external interface application. They will be run each time the application is used in order to track and report the behavior of the user for later analysis.</p>
<p>We start with the provided code snippet below, from a third party provider.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.example.com/track/js?id=UA-XXXXXX-Y&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
   <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">||</span> <span class="p">[];</span>
   <span class="kd">function</span> <span class="nx">track</span><span class="p">(){</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);}</span>
   <span class="nx">track</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>

   <span class="nx">track</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;UA-XXXXXX-Y&#39;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>First line of the snippet refers to an <em>external</em> resource which should be loaded by the <code class="docutils literal notranslate"><span class="pre">script</span></code> tag.</p>
<p>In the script block below, we have some <em>inline</em> code which is run immediately when the page is loaded.</p>
<div class="section" id="adding-external-script-resources">
<h4>Adding External Script Resources<a class="headerlink" href="#adding-external-script-resources" title="Permalink to this headline">¶</a></h4>
<p>First, we need to include the external script location in the appropriate configuration:</p>
<ol class="arabic simple">
<li>Go to the <em>System Configuration</em> screen.</li>
<li>Search for the setting <code class="docutils literal notranslate"><span class="pre">ExternalFrontend::ExternalScripts</span></code>.</li>
<li>Click on the setting in order to edit it.</li>
<li>In case a value is already present, click on the plus button. Otherwise, proceed below.</li>
<li>Enter the full location of the <em>external</em> resource in the text field. For example: <code class="docutils literal notranslate"><span class="pre">https://www.example.com/track/js?id=UA-XXXXXX-Y</span></code>.</li>
<li>Click on the check mark in order to save the modified setting.</li>
<li>Deploy the modified system configuration.</li>
</ol>
</div>
<div class="section" id="adding-inline-code-snippets">
<h4>Adding Inline Code Snippets<a class="headerlink" href="#adding-inline-code-snippets" title="Permalink to this headline">¶</a></h4>
<p>Next, we have to also include the inline part of the original snippet:</p>
<ol class="arabic">
<li><p class="first">Go to the <em>System Configuration</em> screen.</p>
</li>
<li><p class="first">Search for the setting <code class="docutils literal notranslate"><span class="pre">ExternalFrontend::InlineScripts</span></code>.</p>
</li>
<li><p class="first">Click on the setting in order to edit it.</p>
</li>
<li><p class="first">In case a value is already present, click on the plus button. Otherwise, proceed below.</p>
</li>
<li><p class="first">Enter the full code snippet in the text area, minus any <code class="docutils literal notranslate"><span class="pre">script</span></code> tags. For example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span> <span class="o">||</span> <span class="p">[];</span>
<span class="kd">function</span> <span class="nx">track</span><span class="p">(){</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);}</span>
<span class="nx">track</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>

<span class="nx">track</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;UA-XXXXXX-Y&#39;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Click on the check mark in order to save the modified setting.</p>
</li>
<li><p class="first">Deploy the modified system configuration.</p>
</li>
</ol>
</div>
<div class="section" id="rebuilding-the-external-interface-application">
<h4>Rebuilding the External Interface Application<a class="headerlink" href="#rebuilding-the-external-interface-application" title="Permalink to this headline">¶</a></h4>
<p>In order to apply the changes, we also need to rebuild the external interface application. Drop down to shell, and execute the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin/otrs.WebServer.pl --deploy-assets
</pre></div>
</div>
</div>
<div class="section" id="whitelisting-additional-origins-in-the-security-headers">
<h4>Whitelisting Additional Origins in the Security Headers<a class="headerlink" href="#whitelisting-additional-origins-in-the-security-headers" title="Permalink to this headline">¶</a></h4>
<p>If you now try to access the external interface application, you will be able to verify that the scripts are included in the code. However, your browser will probably block access to all <em>inline</em> and <em>external</em> resources, therefore the code might fail with some errors.</p>
<p>This behavior is by design, since external resources can only be loaded if they are specifically whitelisted in the <em>Content Security Policy</em> headers.</p>
<p>To check for blocked code, please use suitable web browser inspection tools. In our example, we will be using Mozilla Firefox and its web console available via <em>Tools → Web Developer → Web Console</em> menu item, or via the <em>F12</em> shortcut key.</p>
<p>For the example code snippet, you might receive following errors in the console when the application is accessed:</p>
<div class="figure" id="id3">
<img alt="Browser Console Errors and Warnings" src="../../_images/csp-console-errors-1.png" />
<p class="caption"><span class="caption-text">Browser Console Errors and Warnings</span></p>
</div>
<p>From the console errors we can see that the external script resource was prevented from being loaded (lines 1 and 3). In addition to that, two evaluation calls were also blocked (lines 2 and 5). All errors reference a <em>Content Security Policy</em> rule under the name of <code class="docutils literal notranslate"><span class="pre">script-src</span></code>, which signals script resources.</p>
<p>We need to add both the external resource and the evaluation calls to the additional origins list of the <em>Content Security Policy</em> headers:</p>
<ol class="arabic simple">
<li>Go to the <em>System Configuration</em> screen.</li>
<li>Search for the setting <code class="docutils literal notranslate"><span class="pre">WebApp::Server::AdditionalOrigins</span></code>.</li>
<li>Click on the setting in order to edit it.</li>
<li>In case a value for <code class="docutils literal notranslate"><span class="pre">script-src</span></code> is already present, click on the plus button next to it. Otherwise, proceed below.</li>
<li>Enter the domain part only of the blocked resource in the text field. For example: <code class="docutils literal notranslate"><span class="pre">https://www.example.com</span></code>. This allows the external resource to be loaded.</li>
<li>Click on the plus button next to the field, so another value is added.</li>
<li>Enter the following directive in the new field, including the quotes: <code class="docutils literal notranslate"><span class="pre">'unsafe-eval'</span></code>. This allows the evaluation calls to be executed.</li>
<li>Click on the check mark in order to save the modified setting.</li>
<li>Deploy the modified system configuration.</li>
</ol>
<p>There is no need to rebuild the external interface application at this point, as the additional origins configuration should be immediately in effect.</p>
<p>If you reload the external interface application, you might get some additional errors. In our example, it might be the following:</p>
<div class="figure" id="id4">
<img alt="Additional Browser Console Errors and Warnings" src="../../_images/csp-console-errors-2.png" />
<p class="caption"><span class="caption-text">Additional Browser Console Errors and Warnings</span></p>
</div>
<p>This error points that an additional resource that was also blocked, an image at a specific location (line 1). We can deduce this via the name of the <em>Content Security Policy</em> rule <code class="docutils literal notranslate"><span class="pre">img-src</span></code>, which references an image resource. In order to add it to the whitelist, try the following:</p>
<ol class="arabic simple">
<li>Go to the <em>System Configuration</em> screen.</li>
<li>Search for the setting <code class="docutils literal notranslate"><span class="pre">WebApp::Server::AdditionalOrigins</span></code>.</li>
<li>Click on the setting in order to edit it.</li>
<li>In case a value for <code class="docutils literal notranslate"><span class="pre">img-src</span></code> is already present, click on the plus button next to it. Otherwise, proceed below.</li>
<li>Enter the domain part only of the blocked resource in the text field. For example: <code class="docutils literal notranslate"><span class="pre">https://www.example.com</span></code>. This allows the external image resource to be loaded.</li>
<li>Click on the check mark in order to save the modified setting.</li>
<li>Deploy the modified system configuration.</li>
</ol>
<p>Try again to reload the external interface application and check if there are more errors. If not, your scripts are now probably working as expected.</p>
<p>Unfortunately, it is not possible to predict what kind of resources your scripts might be requiring. But, no worries, you can whitelist most of them, just make sure to follow the trail of hints shown in the browser console log. Find a corresponding header rule in the configuration and update it accordingly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some resources might only be requested by others, hence several iterations might be needed until everything is configured properly.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Whitelisting external resources opens potential security risks in your OTRS application! Only allow those resources that you are sure are not malicious and come from reputable sources. Keep in mind that if something is secure today, does not mean it will be tomorrow. Stay safe!</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          

<script>
// Start Google Analytics Tracking
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-28118796-2', 'auto');
ga('send', 'pageview');
// End Google Analytics Tracking
</script>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../otrs-group-services.html" class="btn btn-neutral float-right" title="OTRS Group Services" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="home-page.html" class="btn btn-neutral" title="Home Page" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2001-2020 OTRS AG, https://otrs.com/

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>