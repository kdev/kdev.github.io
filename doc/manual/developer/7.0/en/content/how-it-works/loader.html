

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The CSS and JavaScript Loader &mdash; OTRS Developer Manual 7.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/otrs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Templating Mechanism" href="templates.html" />
    <link rel="prev" title="Skins" href="skins.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
    
    
    <a href="https://doc.otrs.com/doc" class="icon fa-rocket DocumentationOverview"> OTRS Documentation</a>

    

          
            <a href="../index.html" class="icon icon-home"> OTRS Developer Manual
          

          
            
            <img src="../../_static/otrs-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../how-it-works.html">OTRS Internals - How it Works</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-mechanism.html">Config Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="database-mechanism.html">Database Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="log-mechanism.html">Log Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="date-time.html">Date and Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="skins.html">Skins</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The CSS and JavaScript Loader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-operation">Basic Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-loader-javascript">Configuring the Loader: JavaScript</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#common-javascript">Common JavaScript</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-specific-javascript">Module Specific JavaScript</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-loader-css">Configuring the Loader: CSS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#common-css">Common CSS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Templating Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="themes.html">Creating Your Own Themes</a></li>
<li class="toctree-l2"><a class="reference internal" href="translations.html">Localization / Translation Mechanism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how-to-extend-otrs.html">How to Extend OTRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to-publish-otrs-extensions.html">How to Publish Your OTRS Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to OTRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional-resources.html">Additional Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OTRS Developer Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../how-it-works.html">OTRS Internals - How it Works</a> &raquo;</li>
        
      <li>The CSS and JavaScript Loader</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OTRS/doc-developer/blob/rel-7_0/content/how-it-works/loader.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-css-and-javascript-loader">
<h1>The CSS and JavaScript Loader<a class="headerlink" href="#the-css-and-javascript-loader" title="Permalink to this headline">¶</a></h1>
<p>The CSS and JavaScript code in OTRS grew to a large amount. To be able to satisfy both development concerns (good maintainability by a large number of separate files) and performance issues (making few HTTP requests and serving minified content without unnecessary whitespace and documentation) had to be addressed. To achieve these goals, the loader was invented.</p>
<div class="section" id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>To put it simple, the loader:</p>
<ul class="simple">
<li>determines for each request precisely which CSS and JavaScript files are needed at the client side by the current application module</li>
<li>collects all the relevant data</li>
<li>minifies the data, removing unnecessary whitespace and documentation</li>
<li>serves it to the client in only a few HTTP requests instead of many individual ones, allowing the client to cache these snippets in the browser cache</li>
<li>performs these tasks in a highly performing way, utilizing the caching mechanisms of OTRS</li>
</ul>
<p>Of course, there is a little bit more detailed involved, but this should suffice as a first overview.</p>
</div>
<div class="section" id="basic-operation">
<h2>Basic Operation<a class="headerlink" href="#basic-operation" title="Permalink to this headline">¶</a></h2>
<p>With the configuration settings <code class="docutils literal notranslate"><span class="pre">Loader::Enabled::CSS</span></code> and <code class="docutils literal notranslate"><span class="pre">Loader::Enabled::JavaScript</span></code>, the loader can be turned on and off for CSS and JavaScript, respectively (it is on by default).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Because of rendering problems in Internet Explorer, the loader cannot be turned off for CSS files for this client browser (config setting will be overridden). Up to version 8, Internet Explorer cannot handle   more than 32 CSS files on a page.</p>
</div>
<p>To learn about how the loader works, please turn it off in your OTRS installation with the aforementioned configuration settings. Now look at the source code of the application module that you are currently using in this OTRS system (after a reload, of course). You will see that there are many CSS files loaded in the <code class="docutils literal notranslate"><span class="pre">&lt;head&gt;</span></code> section of the page, and many JavaScript files at the bottom of the page, just before the closing <code class="docutils literal notranslate"><span class="pre">&lt;/body&gt;</span></code> element.</p>
<p>Having the content like this in many individual files with a readable formatting makes the development much easier, and even possible at all. However, this has the disadvantage of a large number of HTTP requests (network latency has a big effect) and unnecessary content (whitespace and documentation) which needs to be transferred to the client.</p>
<p>The loader solves this problem by performing the steps outlined in the short description above. Please turn on the Loader again and reload your page now. Now you can see that there are only very few CSS and JavaScript tags in the HTML code, like this:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/otrs30-dev-web/js/js-cache/CommonJS_d16010491cbd4faaaeb740136a8ecbfd.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/otrs30-dev-web/js/js-cache/ModuleJS_b54ba9c085577ac48745f6849978907c.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>What just happened? During the original request generating the HTML code for this page, the Loader generated these two files (or took them from the cache) and put the shown <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tags on the page which link to these files, instead of linking to all relevant JavaScript files separately (as you saw it without the loader being active).</p>
<p>The CSS section looks a little more complicated:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/otrs30-dev-web/skins/Agent/default/css-cache/CommonCSS_00753c78c9be7a634c70e914486bfbad.css&quot;</span> <span class="p">/&gt;</span>

<span class="c">&lt;!--[if IE 7]&gt;</span>
<span class="c">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/otrs30-dev-web/skins/Agent/default/css-cache/CommonCSS_IE7_59394a0516ce2e7359c255a06835d31f.css&quot; /&gt;</span>
<span class="c">&lt;![endif]--&gt;</span>

<span class="c">&lt;!--[if IE 8]&gt;</span>
<span class="c">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/otrs30-dev-web/skins/Agent/default/css-cache/CommonCSS_IE8_ff58bd010ef0169703062b6001b13ca9.css&quot; /&gt;</span>
<span class="c">&lt;![endif]--&gt;</span>
</pre></div>
</div>
<p>The reason is that Internet Explorer 7 and 8 need special treatment in addition to the default CSS because of their lacking support of web standard technologies. So we have some normal CSS that is loaded in all browsers, and some special CSS that is inside of so-called <em>conditional comments</em> which cause it to be loaded <strong>only</strong> by Internet Explorer 7/8. All other browsers will ignore it.</p>
<p>Now we have outlined how the loader works. Let’s look at how you can utilize that in your own OTRS extensions by adding configuration data to the loader, telling it to load additional or alternative CSS or JavaScript content.</p>
</div>
<div class="section" id="configuring-the-loader-javascript">
<h2>Configuring the Loader: JavaScript<a class="headerlink" href="#configuring-the-loader-javascript" title="Permalink to this headline">¶</a></h2>
<p>To be able to operate correctly, the loader needs to know which content it has to load for a particular OTRS application module. First, it will look for JavaScript files which <em>always</em> have to be loaded, and then it looks for special files which are only relevant for the current application module.</p>
<div class="section" id="common-javascript">
<h3>Common JavaScript<a class="headerlink" href="#common-javascript" title="Permalink to this headline">¶</a></h3>
<p>The list of JavaScript files to be loaded is configured in the configuration settings <code class="docutils literal notranslate"><span class="pre">Loader::Agent::CommonJS</span></code> (for the agent interface) and <code class="docutils literal notranslate"><span class="pre">Loader::Customer::CommonJS</span></code> (for the customer interface).</p>
<p>These settings are designed as hashes, so that OTRS extensions can add their own hash keys for additional content to be loaded. Let’s look at an example:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;Loader::Agent::CommonJS###000-Framework&quot;</span> <span class="na">Required=</span><span class="s">&quot;1&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>List of JS files to always be loaded for the agent interface.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Navigation&gt;</span>Frontend::Base::Loader<span class="nt">&lt;/Navigation&gt;</span>
    <span class="nt">&lt;Value&gt;</span>
        <span class="nt">&lt;Array&gt;</span>
            <span class="nt">&lt;Item&gt;</span>thirdparty/jquery-3.2.1/jquery.js<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item&gt;</span>thirdparty/jquery-browser-detection/jquery-browser-detection.js<span class="nt">&lt;/Item&gt;</span>

            ...

            <span class="nt">&lt;Item&gt;</span>Core.Agent.Header.js<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item&gt;</span>Core.UI.Notification.js<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item&gt;</span>Core.Agent.Responsive.js<span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;/Array&gt;</span>
    <span class="nt">&lt;/Value&gt;</span>
<span class="nt">&lt;/Setting&gt;</span>
</pre></div>
</div>
<p>This is the list of JavaScript files which always need to be loaded for the agent interface of OTRS.</p>
<p>To add new content which is supposed to be loaded always in the agent interface, just add an XML configuration file with another hash entry:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;Loader::Agent::CommonJS###000-Framework&quot;</span> <span class="na">Required=</span><span class="s">&quot;1&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>List of JS files to always be loaded for the agent interface.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Navigation&gt;</span>Frontend::Base::Loader<span class="nt">&lt;/Navigation&gt;</span>
    <span class="nt">&lt;Value&gt;</span>
        <span class="nt">&lt;Array&gt;</span>
            <span class="nt">&lt;Item&gt;</span>thirdparty/jquery-3.2.1/jquery.js<span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;/Array&gt;</span>
    <span class="nt">&lt;/Value&gt;</span>
<span class="nt">&lt;/Setting&gt;</span>
</pre></div>
</div>
<p>Simple, isn’t it?</p>
</div>
<div class="section" id="module-specific-javascript">
<h3>Module Specific JavaScript<a class="headerlink" href="#module-specific-javascript" title="Permalink to this headline">¶</a></h3>
<p>Not all JavaScript is usable for all application modules of OTRS. Therefore it is possible to specify module specific JavaScript files. Whenever a certain module is used (such as <code class="docutils literal notranslate"><span class="pre">AgentDashboard</span></code>), the module specific JavaScript for this module will also be loaded. The configuration is done in the front end module registration in the XML configurations. Again, an example:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;Loader::Module::AgentDashboard###001-Framework&quot;</span> <span class="na">Required=</span><span class="s">&quot;0&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>Loader module registration for the agent interface.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Navigation&gt;</span>Frontend::Agent::ModuleRegistration::Loader<span class="nt">&lt;/Navigation&gt;</span>
    <span class="nt">&lt;Value&gt;</span>
        <span class="nt">&lt;Hash&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;CSS&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Array&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>Core.Agent.Dashboard.css<span class="nt">&lt;/Item&gt;</span>

                    ...

                <span class="nt">&lt;/Array&gt;</span>
            <span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;JavaScript&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Array&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/momentjs-2.18.1/moment.min.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/fullcalendar-3.4.0/fullcalendar.min.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/d3-3.5.6/d3.min.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/nvd3-1.7.1/nvd3.min.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/nvd3-1.7.1/models/OTRSLineChart.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/nvd3-1.7.1/models/OTRSMultiBarChart.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/nvd3-1.7.1/models/OTRSStackedAreaChart.js<span class="nt">&lt;/Item&gt;</span>
                    <span class="nt">&lt;Item&gt;</span>thirdparty/canvg-1.4/rgbcolor.js<span class="nt">&lt;/Item&gt;</span>
                <span class="nt">&lt;/Array&gt;</span>
            <span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;/Hash&gt;</span>
    <span class="nt">&lt;/Value&gt;</span>
<span class="nt">&lt;/Setting&gt;</span>
</pre></div>
</div>
<p>It is possible to put a <code class="docutils literal notranslate"><span class="pre">&lt;Item</span> <span class="pre">Key=&quot;JavaScript&quot;&gt;</span></code> tag in the front end module registrations which may contain <code class="docutils literal notranslate"><span class="pre">&lt;Array&gt;</span></code> and one tag <code class="docutils literal notranslate"><span class="pre">&lt;Item&gt;</span></code> for each JavaScript file that is supposed to be loaded for
this application module.</p>
<p>Now you have all information you need to configure the way the loader handles JavaScript code.</p>
</div>
</div>
<div class="section" id="configuring-the-loader-css">
<h2>Configuring the Loader: CSS<a class="headerlink" href="#configuring-the-loader-css" title="Permalink to this headline">¶</a></h2>
<p>The loader handles CSS files very similar to JavaScript files, as described in the previous section, and
extending the settings works in the same way too.</p>
<div class="section" id="common-css">
<h3>Common CSS<a class="headerlink" href="#common-css" title="Permalink to this headline">¶</a></h3>
<p>The way common CSS is handled is very similar to the way <a class="reference internal" href="#common-javascript"><span class="std std-ref">Common JavaScript</span></a> is loaded.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          

<script>
// Start Google Analytics Tracking
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-28118796-2', 'auto');
ga('send', 'pageview');
// End Google Analytics Tracking
</script>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="templates.html" class="btn btn-neutral float-right" title="Templating Mechanism" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="skins.html" class="btn btn-neutral" title="Skins" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2001-2020 OTRS AG, https://otrs.com/

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>