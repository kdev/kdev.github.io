

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Templating Mechanism &mdash; OTRS Developer Manual 8.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/otrs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating Your Own Themes" href="themes.html" />
    <link rel="prev" title="The CSS and JavaScript Loader" href="loader.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
    
    
    <a href="https://doc.otrs.com/doc" class="icon fa-rocket DocumentationOverview"> OTRS Documentation</a>

    

          
            <a href="../index.html" class="icon icon-home"> OTRS Developer Manual
          

          
            
            <img src="../../_static/otrs-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../how-it-works.html">OTRS Internals - How it Works</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-mechanism.html">Config Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="database-mechanism.html">Database Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="log-mechanism.html">Log Mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="date-time.html">Date and Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="skins.html">Skins</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader.html">The CSS and JavaScript Loader</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Templating Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#template-commands">Template Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inserting-dynamic-data">Inserting Dynamic Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#localization-commands">Localization Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#template-processing-commands">Template Processing Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wrapper-jsondocumentcomplete-end"><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">WRAPPER</span> <span class="pre">JSOnDocumentComplete</span> <span class="pre">%]...[%</span> <span class="pre">END</span> <span class="pre">%]</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-a-template-file">Using a Template File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="themes.html">Creating Your Own Themes</a></li>
<li class="toctree-l2"><a class="reference internal" href="translations.html">Localization / Translation Mechanism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how-to-extend-otrs.html">How to Extend OTRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to-publish-otrs-extensions.html">How to Publish Your OTRS Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to OTRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional-resources.html">Additional Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OTRS Developer Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../how-it-works.html">OTRS Internals - How it Works</a> &raquo;</li>
        
      <li>Templating Mechanism</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OTRS/doc-developer/blob/rel-8_0/content/how-it-works/templates.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="templating-mechanism">
<h1>Templating Mechanism<a class="headerlink" href="#templating-mechanism" title="Permalink to this headline">¶</a></h1>
<p>Internally, OTRS uses a templating mechanism to dynamically generate its HTML pages (and other content), while keeping the program logic (Perl) and the presentation (HTML) separate. Typically, a front end module will use an own template file, pass some data to it and return the rendered result to the user.</p>
<p>The template files are located at <code class="docutils literal notranslate"><span class="pre">$OTRS_HOME/Kernel/Output/HTML/Standard/*.tt</span></code>.</p>
<p>OTRS relies on <a class="reference external" href="http://www.template-toolkit.org/">the Template::Toolkit rendering engine</a>. The full Template::Toolkit syntax can be used in OTRS templates. This section describes some example use cases and OTRS extensions to the Template::Toolkit syntax.</p>
<div class="section" id="template-commands">
<h2>Template Commands<a class="headerlink" href="#template-commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="inserting-dynamic-data">
<h3>Inserting Dynamic Data<a class="headerlink" href="#inserting-dynamic-data" title="Permalink to this headline">¶</a></h3>
<p>In templates, dynamic data must be inserted, quoted etc. This section lists the relevant commands to do that.</p>
<div class="section" id="data-name">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">%]</span></code><a class="headerlink" href="#data-name" title="Permalink to this headline">¶</a></h4>
<p>If data parameters are given to the templates by the application module, these data can be output to the template. <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">%]</span></code> is the most simple, but also most dangerous one. It will insert the data parameter whose name is <code class="docutils literal notranslate"><span class="pre">Name</span></code> into the template as it is, without further processing.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Because of the missing HTML quoting, this can result in security problems. Never output data that was input by a user without quoting in HTML context. The user could - for example - just insert a <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tag, and it would be output on the HTML page generated by OTRS.</p>
<p class="last">Whenever possible, use <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">|</span> <span class="pre">html</span> <span class="pre">%]</span></code> (in HTML) or <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">|</span> <span class="pre">uri</span> <span class="pre">%]</span></code> (in links) instead.</p>
</div>
<p>Example: Whenever we generate HTML in the application, we need to output it to the template without HTML quoting, like <code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code> elements, which are generated by the function <code class="docutils literal notranslate"><span class="pre">Layout::BuildSelection()</span></code> in OTRS.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;Dropdown&quot;</span><span class="p">&gt;</span>Example Dropdown<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
[% Data.DropdownString&quot;]
</pre></div>
</div>
<p>If you have data entries with complex names containing special characters, you cannot use the dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>) notation to access this data. Use <code class="docutils literal notranslate"><span class="pre">item()</span></code> instead: <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.item('Complex-name')</span> <span class="pre">%]</span></code>.</p>
</div>
<div class="section" id="data-name-html">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">|</span> <span class="pre">html</span> <span class="pre">%]</span></code><a class="headerlink" href="#data-name-html" title="Permalink to this headline">¶</a></h4>
<p>This command has the same function as the previous one, but it performs HTML quoting on the data as it is inserted to the template.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>The name of the author is [% Data.Name | html %].
</pre></div>
</div>
<p>It’s also possible specify a maximum length for the value. If, for example, you just want to show 8 characters of a variable (result will be <em>SomeName[…]</em>), use the following:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>The first 20 characters of the author&#39;s name: [% Data.Name | truncate(20) | html %].
</pre></div>
</div>
</div>
<div class="section" id="data-name-uri">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">|</span> <span class="pre">uri</span> <span class="pre">%]</span></code><a class="headerlink" href="#data-name-uri" title="Permalink to this headline">¶</a></h4>
<p>This command performs <a class="reference external" href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a> on the data as it is inserted to the template. This should be used to output single parameter names or values of URLs, to prevent security problems. It cannot be used for complete URLs because it will also mask <code class="docutils literal notranslate"><span class="pre">=</span></code>, for example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;a href=&quot;[% Env(&quot;Baselink&quot;) %];Location=[% Data.File | uri %]&quot;&gt;[% Data.File | truncate(110) | html %]&lt;/a&gt;
</pre></div>
</div>
</div>
<div class="section" id="data-name-json">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Data.Name</span> <span class="pre">|</span> <span class="pre">JSON</span> <span class="pre">%]</span></code><a class="headerlink" href="#data-name-json" title="Permalink to this headline">¶</a></h4>
<p>This command outputs a string or another data structure as a JavaScript JSON string.</p>
<div class="highlight-JavaScript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">Text</span> <span class="o">=</span> <span class="p">[</span><span class="o">%</span> <span class="nx">Data</span><span class="p">.</span><span class="nx">Text</span> <span class="o">|</span> <span class="nx">JSON</span> <span class="o">%</span><span class="p">];</span>
</pre></div>
</div>
<p>Please note that the filter notation will only work for simple strings. To output complex data as JSON, please use it as a function:</p>
<div class="highlight-JavaScript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">TreeData</span> <span class="o">=</span> <span class="p">[</span><span class="o">%</span> <span class="nx">JSON</span><span class="p">(</span><span class="nx">Data</span><span class="p">.</span><span class="nx">TreeData</span><span class="p">)</span> <span class="o">%</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="env">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env()</span> <span class="pre">%]</span></code><a class="headerlink" href="#env" title="Permalink to this headline">¶</a></h4>
<p>Inserts environment variables provided by the <code class="docutils literal notranslate"><span class="pre">LayoutObject</span></code>. Some examples:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>The current user name is: [% Env(&quot;UserFullname&quot;) %]
</pre></div>
</div>
<p>Some other common predefined variables are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;Action&quot;)</span> <span class="pre">%]</span></code>: the current action</li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;Baselink&quot;)</span> <span class="pre">%]</span></code>: the baselink, e. g. <code class="docutils literal notranslate"><span class="pre">index.pl?SessionID=...</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;CGIHandle&quot;)</span> <span class="pre">%]</span></code>: the current CGI handle e. g. <code class="docutils literal notranslate"><span class="pre">index.pl</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;SessionID&quot;)</span> <span class="pre">%]</span></code>: the current session id</li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;Time&quot;)</span> <span class="pre">%]</span></code>: the current time e. g. <em>Thu Dec 27 16:00:55 2001</em></li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;UserFullname&quot;)</span> <span class="pre">%]</span></code>: e. g. Dirk Seiffert</li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;UserIsGroup[admin]&quot;)</span> <span class="pre">%]</span></code>: Yes</li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;UserIsGroup[users]&quot;)</span> <span class="pre">%]</span></code>: Yes, user groups (useful for own links)</li>
<li><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Env(&quot;UserLogin&quot;)</span> <span class="pre">%]</span></code>: e. g. <a class="reference external" href="mailto:mgg&#37;&#52;&#48;x11&#46;org">mgg<span>&#64;</span>x11<span>&#46;</span>org</a></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Because of the missing HTML quoting, this can result in security problems. Never output data that was input by a user without quoting in HTML context. The user could - for example - just insert a <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tag, and it would be output on the HTML page generated by OTRS.</p>
<p class="last">Don’t forget to add the <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">html</span></code> filter where appropriate.</p>
</div>
</div>
<div class="section" id="config">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Config()</span> <span class="pre">%]</span></code><a class="headerlink" href="#config" title="Permalink to this headline">¶</a></h4>
<p>Inserts configuration variables into the template. Let’s see an example <code class="docutils literal notranslate"><span class="pre">Kernel/Config.pm</span></code>:</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Kernel</span><span class="o">/</span><span class="n">Config</span><span class="o">.</span><span class="n">pm</span><span class="p">]</span>
    <span class="c1"># FQDN</span>
    <span class="c1"># (Full qualified domain name of your system.)</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FQDN</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;otrs.example.com&#39;</span><span class="p">;</span>
    <span class="c1"># AdminEmail</span>
    <span class="c1"># (Email of the system admin.)</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">AdminEmail</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;admin@example.com&#39;</span><span class="p">;</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>To output values from it in the template, use:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>The hostname is &#39;$Config{&quot;FQDN&quot;}&#39;
The admin email address is &#39;[% Config(&quot;AdminEmail&quot;) %]&#39;
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Because of the missing HTML quoting, this can result in security problems.</p>
<p class="last">Don’t forget to add the <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">html</span></code> filter where appropriate.</p>
</div>
</div>
</div>
<div class="section" id="localization-commands">
<h3>Localization Commands<a class="headerlink" href="#localization-commands" title="Permalink to this headline">¶</a></h3>
<div class="section" id="translate">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Translate()</span> <span class="pre">%]</span></code><a class="headerlink" href="#translate" title="Permalink to this headline">¶</a></h4>
<p>Translates a string into the current user’s selected language. If no translation is found, the original string will be used.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>Translate this text: [% Translate(&quot;Help&quot;) | html %]
</pre></div>
</div>
<p>You can also translate dynamic data by using <code class="docutils literal notranslate"><span class="pre">Translate</span></code> as a filter:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>Translate data from the application: [% Data.Type | Translate | html %]
</pre></div>
</div>
<p>You can also specify one or more parameters (<code class="docutils literal notranslate"><span class="pre">%s</span></code>) inside of the string which should be replaced with dynamic data:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>Translate this text and insert the given data: [% Translate(&quot;Change %s settings&quot;, Data.Type) | html %]
</pre></div>
</div>
<p>Strings in JavaScript can be translated and processed with the JSON filter.</p>
<div class="highlight-JavaScript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">Text</span> <span class="o">=</span> <span class="p">[</span><span class="o">%</span> <span class="nx">Translate</span><span class="p">(</span><span class="s2">&quot;Change %s settings&quot;</span><span class="p">,</span> <span class="nx">Data</span><span class="p">.</span><span class="nx">Type</span><span class="p">)</span> <span class="o">|</span> <span class="nx">JSON</span> <span class="o">%</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="localize">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Localize()</span> <span class="pre">%]</span></code><a class="headerlink" href="#localize" title="Permalink to this headline">¶</a></h4>
<p>Outputs data according to the current language/locale.</p>
<p>In different cultural areas, different convention for date and time formatting are used. For example, what is the 01.02.2010 in Germany, would be 02/01/2010 in the USA. <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Localize()</span> <span class="pre">%]</span></code> abstracts this away from the templates. Let’s see an example:</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>[% Data.CreateTime ǀ Localize(&quot;TimeLong&quot;) %]
# Result for US English locale:
06/09/2010 15:45:41
</pre></div>
</div>
<p>First, the data is inserted from the application module with <code class="docutils literal notranslate"><span class="pre">Data</span></code>. Here always an ISO UTC timestamp (2010-06-09 15:45:41) must be passed as data to <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Localize()</span> <span class="pre">%]</span></code>. Then it will be output it according to the date/time definition of the current locale.</p>
<p>The data passed to <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">Localize()</span> <span class="pre">%]</span></code> must be UTC. If a time zone offset is specified for the current agent, it will be applied to the UTC timestamp before the output is generated.</p>
<p>There are different possible date/time output formats: <code class="docutils literal notranslate"><span class="pre">TimeLong</span></code> (full date/time), <code class="docutils literal notranslate"><span class="pre">TimeShort</span></code> (no seconds) and <code class="docutils literal notranslate"><span class="pre">Date</span></code> (no time).</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>[% Data.CreateTime ǀ Localize(&quot;TimeLong&quot;) %]
# Result for US English locale:
06/09/2010 15:45:41

[% Data.CreateTime ǀ Localize(&quot;TimeShort&quot;) %]
# Result for US English locale:
06/09/2010 15:45

[% Data.CreateTime ǀ Localize(&quot;Date&quot;) %]
# Result for US English locale:
06/09/2010
</pre></div>
</div>
<p>Also the output of human readable file sizes is available as an option <code class="docutils literal notranslate"><span class="pre">Localize('Filesize')</span></code> (just pass the raw file size in bytes).</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>[% Data.Filesize ǀ Localize(&quot;Filesize&quot;) %]
# Result for US English locale:
23 MB
</pre></div>
</div>
</div>
<div class="section" id="replaceplaceholders">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">ReplacePlaceholders()</span> <span class="pre">%]</span></code><a class="headerlink" href="#replaceplaceholders" title="Permalink to this headline">¶</a></h4>
<p>Replaces placeholders (<code class="docutils literal notranslate"><span class="pre">%s</span></code>) in strings with passed parameters.</p>
<p>In certain cases, you might want to insert HTML code in translations, instead of placeholders. On the other hand, you also need to take care of sanitization, since translated strings should not be trusted as-is. For this, you can first translate the string, pass it through the HTML filter and finally replace placeholders with static (safe) HTML code.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>[% Translate(&quot;This is %s.&quot;) | html | ReplacePlaceholders(&#39;<span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>bold text<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>&#39;) %]
</pre></div>
</div>
<p>Number of parameters to <code class="docutils literal notranslate"><span class="pre">ReplacePlaceholders()</span></code> filter should match number of placeholders in the original string.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">ReplacePlaceholders()</span> <span class="pre">%]</span></code> in function format, in case you are not translating anything. In this case, first parameter is the target string, and any found placeholders in it are substituted with subsequent parameters.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span>[% ReplacePlaceholders(&quot;This string has both %s and %s.&quot;, &#39;<span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>bold text<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>, &#39;<span class="p">&lt;</span><span class="nt">em</span><span class="p">&gt;</span>italic text<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;</span>&#39;) %]
</pre></div>
</div>
</div>
</div>
<div class="section" id="template-processing-commands">
<h3>Template Processing Commands<a class="headerlink" href="#template-processing-commands" title="Permalink to this headline">¶</a></h3>
<div class="section" id="comment">
<h4>Comment<a class="headerlink" href="#comment" title="Permalink to this headline">¶</a></h4>
<p>Lines starting with a # at the beginning of will not be shown in the html output. This can be used both for commenting the Template code or for disabling parts of it.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span># this section is temporarily disabled
# <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;AsBlock&quot;</span><span class="p">&gt;</span>
#     <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;...&quot;</span><span class="p">&gt;</span>link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
# <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="inserttemplate-copyright-tt">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">InsertTemplate(&quot;Copyright.tt&quot;)</span> <span class="pre">%]</span></code><a class="headerlink" href="#inserttemplate-copyright-tt" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please note that the <code class="docutils literal notranslate"><span class="pre">InsertTemplate</span></code> command was added to provide better backwards compatibility to the old DTL system. It might be deprecated in a future version of OTRS and removed later. If you don’t use block commands in your included template, you don’t need <code class="docutils literal notranslate"><span class="pre">InsertTemplate</span></code> and can use standard Template::Toolkit syntax like <code class="docutils literal notranslate"><span class="pre">INCLUDE/PROCESS</span></code> instead.</p>
</div>
<p>Includes another template file into the current one. The included file may also contain template commands.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span># include Copyright.tt
[% InsertTemplate(&quot;Copyright&quot;) %]
</pre></div>
</div>
<p>Please note this is not the same as Template::Toolkit’s <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">INCLUDE</span> <span class="pre">%]</span></code> command, which just processes the referenced template. <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">InsertTemplate()</span> <span class="pre">%]</span></code> actually adds the content of the referenced template into the current template, so that it can be processed together. That makes it possible for the embedded template to access the same environment/data as the main template.</p>
</div>
<div class="section" id="renderblockstart-renderblockend">
<h4><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">RenderBlockStart</span> <span class="pre">%]</span></code> / <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">RenderBlockEnd</span> <span class="pre">%]</span></code><a class="headerlink" href="#renderblockstart-renderblockend" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please note that the blocks commands were added to provide better backwards compatibility to the old DTL system. They might be deprecated in a future version of OTRS and removed later. We advise you to develop any new code without using the blocks commands. You can use standard Template::Toolkit syntax like <code class="docutils literal notranslate"><span class="pre">IF/ELSE</span></code>, <code class="docutils literal notranslate"><span class="pre">LOOP</span></code> and other helpful things for conditional template output.</p>
</div>
<p>With this command, one can specify parts of a template file as a block. This block needs to be explicitly filled with a function call from the application, to be present in the generated output. The application can call the block 0 (it will not be present in the output), 1 or more times (each with possibly a different set of data parameters passed to the template).</p>
<p>One common use case is the filling of a table with dynamic data:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;table class=&quot;DataTable&quot;&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;[% Translate(&quot;Name&quot;) | html %]&lt;/th&gt;
            &lt;th&gt;[% Translate(&quot;Type&quot;) | html %]&lt;/th&gt;
            &lt;th&gt;[% Translate(&quot;Comment&quot;) | html %]&lt;/th&gt;
            &lt;th&gt;[% Translate(&quot;Validity&quot;) | html %]&lt;/th&gt;
            &lt;th&gt;[% Translate(&quot;Changed&quot;) | html %]&lt;/th&gt;
            &lt;th&gt;[% Translate(&quot;Created&quot;) | html %]&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
[% RenderBlockStart(&quot;NoDataFoundMsg&quot;) %]
        &lt;tr&gt;
            &lt;td colspan=&quot;6&quot;&gt;
                [% Translate(&quot;No data found.&quot;) | html %]
            &lt;/td&gt;
        &lt;/tr&gt;
[% RenderBlockEnd(&quot;NoDataFoundMsg&quot;) %]
[% RenderBlockStart(&quot;OverviewResultRow&quot;) %]
        &lt;tr&gt;
            &lt;td&gt;&lt;a class=&quot;AsBlock&quot; href=&quot;[% Env(&quot;Baselink&quot;) %]Action=[% Env(&quot;Action&quot;) %];Subaction=Change;ID=[% Data.ID | uri %]&quot;&gt;[% Data.Name | html %]&lt;/a&gt;&lt;/td&gt;
            &lt;td&gt;[% Translate(Data.TypeName) | html %]&lt;/td&gt;
            &lt;td title=&quot;[% Data.Comment | html %]&quot;&gt;[% Data.Comment | truncate(20) | html %]&lt;/td&gt;
            &lt;td&gt;[% Translate(Data.Valid) | html %]&lt;/td&gt;
            &lt;td&gt;[% Data.ChangeTime | Localize(&quot;TimeShort&quot;) %]&lt;/td&gt;
            &lt;td&gt;[% Data.CreateTime | Localize(&quot;TimeShort&quot;) %]&lt;/td&gt;
        &lt;/tr&gt;
[% RenderBlockEnd(&quot;OverviewResultRow&quot;) %]
    &lt;/tbody&gt;
&lt;/table&gt;
</pre></div>
</div>
<p>The surrounding table with the header is always generated. If no data was found, the block <code class="docutils literal notranslate"><span class="pre">NoDataFoundMsg</span></code> is called once, resulting in a table with one data row with the message <em>No data found</em>.</p>
<p>If data was found, for each row there is one function call made for the block <code class="docutils literal notranslate"><span class="pre">OverViewResultRow</span></code> (each time passing in the data for this particular row), resulting in a table with as many data rows as results were found.</p>
<p>Let’s look at how the blocks are called from the application module:</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">my</span> <span class="nv">%List</span> <span class="o">=</span> <span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::System::State)-&gt;StateList(</span>
<span class="s">    UserID =&gt; 1,</span>
<span class="s">    Valid  =&gt; 0,</span>
<span class="s">);</span>

<span class="s"># if there are any states, they are shown</span>
<span class="s">if (%List) {</span>

<span class="s">    # get valid list</span>
<span class="s">    my %ValidList = $Kernel::OM-&gt;Get(&#39;</span><span class="nn">Kernel::System::</span><span class="n">Valid</span><span class="s">&#39;)-&gt;ValidList();</span>
<span class="s">    for my $ListKey ( sort { $List{$a} cmp $List{$b} } keys %List ) {</span>

<span class="s">        my %Data = $Kernel::OM-&gt;Get(&#39;</span><span class="nn">Kernel::System::</span><span class="n">State</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">StateGet</span><span class="p">(</span> <span class="n">ID</span> <span class="o">=&gt;</span> <span class="nv">$ListKey</span> <span class="p">);</span>
        <span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::Output::HTML::Layout&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Block</span><span class="p">(</span>
            <span class="n">Name</span> <span class="o">=&gt;</span> <span class="s">&#39;OverviewResultRow&#39;</span><span class="p">,</span>
            <span class="n">Data</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">Valid</span> <span class="o">=&gt;</span> <span class="nv">$ValidList</span><span class="p">{</span> <span class="nv">$Data</span><span class="p">{</span><span class="n">ValidID</span><span class="p">}</span> <span class="p">},</span>
                <span class="nv">%Data</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># otherwise a no data found msg is displayed</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::Output::HTML::Layout&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Block</span><span class="p">(</span>
        <span class="n">Name</span> <span class="o">=&gt;</span> <span class="s">&#39;NoDataFoundMsg&#39;</span><span class="p">,</span>
        <span class="n">Data</span> <span class="o">=&gt;</span> <span class="p">{},</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note how the blocks have both their name and an optional set of data passed in as separate parameters to the block function call. Data inserting commands inside a block always need the data provided to the block function call of this block, not the general template rendering call.</p>
<p>For more information see the <a class="reference external" href="https://doc.otrs.com/doc/">Documentation Portal</a>.</p>
</div>
</div>
<div class="section" id="wrapper-jsondocumentcomplete-end">
<h3><code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">WRAPPER</span> <span class="pre">JSOnDocumentComplete</span> <span class="pre">%]...[%</span> <span class="pre">END</span> <span class="pre">%]</span></code><a class="headerlink" href="#wrapper-jsondocumentcomplete-end" title="Permalink to this headline">¶</a></h3>
<p>Marks JavaScript code which should be executed after all CSS, JavaScript and other external content has been loaded and the basic JavaScript initialization was finished. Again, let’s look at an example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;form action=&quot;[% Env(&quot;CGIHandle&quot;) %]&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; name=&quot;MoveTicketToQueue&quot; class=&quot;Validate PreventMultipleSubmits&quot; id=&quot;MoveTicketToQueue&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;Action&quot;       value=&quot;[% Env(&quot;Action&quot;) %]&quot;/&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;Subaction&quot;    value=&quot;MoveTicket&quot;/&gt;

    ...

    &lt;div class=&quot;Content&quot;&gt;
        &lt;fieldset class=&quot;TableLike FixedLabel&quot;&gt;
            &lt;label class=&quot;Mandatory&quot; for=&quot;DestQueueID&quot;&gt;&lt;span class=&quot;Marker&quot;&gt;*&lt;/span&gt; [% Translate(&quot;New Queue&quot;) | html %]:&lt;/label&gt;
            &lt;div class=&quot;Field&quot;&gt;
                [% Data.MoveQueuesStrg %]
                &lt;div id=&quot;DestQueueIDError&quot; class=&quot;TooltipErrorMessage&quot; &gt;&lt;p&gt;[% Translate(&quot;This field is required.&quot;) | html %]&lt;/p&gt;&lt;/div&gt;
                &lt;div id=&quot;DestQueueIDServerError&quot; class=&quot;TooltipErrorMessage&quot;&gt;&lt;p&gt;[% Translate(&quot;This field is required.&quot;) | html %]&lt;/p&gt;&lt;/div&gt;
[% WRAPPER JSOnDocumentComplete %]
&lt;script type=&quot;text/javascript&quot;&gt;
    $(&#39;#DestQueueID&#39;).bind(&#39;change&#39;, function (Event) {
        $(&#39;#NoSubmit&#39;).val(&#39;1&#39;);
        Core.AJAX.FormUpdate($(&#39;#MoveTicketToQueue&#39;), &#39;AJAXUpdate&#39;, &#39;DestQueueID&#39;, [&#39;NewUserID&#39;, &#39;OldUserID&#39;, &#39;NewStateID&#39;, &#39;NewPriorityID&#39; [% Data.DynamicFieldNamesStrg %]]);
    });
&lt;/script&gt;
[% END %]
                    &lt;/div&gt;
                    &lt;div class=&quot;Clear&quot;&gt;&lt;/div&gt;
</pre></div>
</div>
<p>This snippet creates a small form and puts an <code class="docutils literal notranslate"><span class="pre">onchange</span></code> handler on the <code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code> element which triggers an AJAX based form update.</p>
<p>Why is it necessary to enclose the JavaScript code in <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">WRAPPER</span> <span class="pre">JSOnDocumentComplete</span> <span class="pre">%]...[%</span> <span class="pre">END</span> <span class="pre">%]</span></code>? JavaScript loading was moved to the footer part of the page for performance reasons. This means that within the <code class="docutils literal notranslate"><span class="pre">&lt;body&gt;</span></code> of the page, no JavaScript libraries are loaded yet. With <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">WRAPPER</span> <span class="pre">JSOnDocumentComplete</span> <span class="pre">%]...[%</span> <span class="pre">END</span> <span class="pre">%]</span></code> you can make sure that this JavaScript is moved to a part of the final HTML document, where it will be executed only after the entire external JavaScript and CSS content has been successfully loaded and initialized.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">[%</span> <span class="pre">WRAPPER</span> <span class="pre">JSOnDocumentComplete</span> <span class="pre">%]...[%</span> <span class="pre">END</span> <span class="pre">%]</span></code> block, you can use <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tags to enclose your JavaScript code, but you do not have to do so. It may be beneficial because it will enable correct syntax highlighting in IDEs which support it.</p>
</div>
</div>
<div class="section" id="using-a-template-file">
<h2>Using a Template File<a class="headerlink" href="#using-a-template-file" title="Permalink to this headline">¶</a></h2>
<p>Ok, but how to actually process a template file and generate the result? This is really simple:</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="c1"># render AdminState.tt</span>
<span class="nv">$Output</span> <span class="o">.=</span> <span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::Output::HTML::Layout&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Output</span><span class="p">(</span>
    <span class="n">TemplateFile</span> <span class="o">=&gt;</span> <span class="s">&#39;AdminState&#39;</span><span class="p">,</span>
    <span class="n">Data</span>         <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">%Param</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In the front end modules, the <code class="docutils literal notranslate"><span class="pre">Output()</span></code> function of <code class="docutils literal notranslate"><span class="pre">Kernel::Output::HTML::Layout</span></code> is called (after all the needed blocks have been called in this template) to generate the final output. An optional set of data parameters is passed to the template, for all data inserting commands which are not inside of a block.</p>
</div>
</div>


           </div>
           
          </div>
          

<script>
// Start Google Analytics Tracking
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-28118796-2', 'auto');
ga('send', 'pageview');
// End Google Analytics Tracking
</script>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="themes.html" class="btn btn-neutral float-right" title="Creating Your Own Themes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="loader.html" class="btn btn-neutral" title="The CSS and JavaScript Loader" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2001-2020 OTRS AG, https://otrs.com/

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>