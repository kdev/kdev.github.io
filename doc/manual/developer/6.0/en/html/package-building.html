<html><head>
<!-- otrs.github.io -->
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../../../../../documentation.css">
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../documentation.js"></script>
<link rel="icon" type="image/png" sizes="32x32" href="../../../../../../images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../../../images/favicon-16x16.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script>
$(document).ready(function() {

    // Hint languages to prevent false matches (php for example).
    hljs.configure({
        languages: ['perl', 'javascript', 'xml', 'html', 'css', 'json', 'yaml']
    });

    // programlistings in manuals
    $('pre.programlisting').each(function(i, block) {
        hljs.highlightBlock(block);
    });
    // code snippets in Perl API docs
    $('.pod pre').addClass('perl').each(function(i, block) {
        hljs.highlightBlock(block);
    });
});</script>
<!-- otrs.github.io -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Package Building</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="OTRS 6 - Developer Manual"><link rel="up" href="how-to-publish-extensions.html" title="Chapter 4. How to Publish Your OTRS Extensions"><link rel="prev" href="how-to-publish-extensions.html" title="Chapter 4. How to Publish Your OTRS Extensions"><link rel="next" href="package-porting.html" title="Package Porting"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Package Building</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="how-to-publish-extensions.html">Prev</a> </td><th width="60%" align="center">Chapter 4. How to Publish Your OTRS Extensions</th><td width="20%" align="right"> <a accesskey="n" href="package-porting.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="package-building"></a>Package Building</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="package-building.html#package-spec-file">Package Spec File</a></span></dt><dd><dl><dt><span class="section"><a href="package-building.html#package-name"><code class="literal">&lt;Name&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-version"><code class="literal">&lt;Version&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-framework"><code class="literal">&lt;Framework&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-vendor"><code class="literal">&lt;Vendor&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-url"><code class="literal">&lt;URL&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-license"><code class="literal">&lt;License&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-changelog"><code class="literal">&lt;ChangeLog&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-description"><code class="literal">&lt;Description&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-possible-actions-installed">Package Actions</a></span></dt><dt><span class="section"><a href="package-building.html#package-buildhost"><code class="literal">&lt;BuildHost&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-builddate"><code class="literal">&lt;BuildDate&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-package-required"><code class="literal">&lt;PackageRequired&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-module-required"><code class="literal">&lt;ModuleRequired&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-os"><code class="literal">&lt;OS&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-filelist"><code class="literal">&lt;Filelist&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-database-install"><code class="literal">&lt;DatabaseInstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-database-upgrade"><code class="literal">&lt;DatabaseUpgrade&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-database-reinstall"><code class="literal">&lt;DatabaseReinstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-database-uninstall"><code class="literal">&lt;DatabaseUninstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-intro-install"><code class="literal">&lt;IntroInstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-intro-uninstall"><code class="literal">&lt;IntroUninstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-intro-reinstall"><code class="literal">&lt;IntroReinstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-intro-upgrade"><code class="literal">&lt;IntroUpgrade&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-code-install"><code class="literal">&lt;CodeInstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-code-uninstall"><code class="literal">&lt;CodeUninstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-code-reinstall"><code class="literal">&lt;CodeReinstall&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-code-upgrade"><code class="literal">&lt;CodeUpgrade&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-packagemerge"><code class="literal">&lt;PackageMerge&gt;</code></a></span></dt><dt><span class="section"><a href="package-building.html#package-conditions-ifpackage-ifnotpackage">Conditions: <code class="literal">IfPackage</code> and <code class="literal">IfNotPackage</code></a></span></dt></dl></dd><dt><span class="section"><a href="package-building.html#package-example-sopm">Example .sopm</a></span></dt><dt><span class="section"><a href="package-building.html#package-build">Package Build</a></span></dt><dt><span class="section"><a href="package-building.html#package-life-cycle">Package Life Cycle - Install/Upgrade/Uninstall</a></span></dt></dl></div><p>
        If you want to create an OPM package (<code class="literal">.opm</code>) you need to create a spec
        file (<code class="literal">.sopm</code>) which includes the properties of the package.
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="package-spec-file"></a>Package Spec File</h3></div></div></div><p>
            The OPM package is XML based. You can create/edit the <code class="literal">.sopm</code> via a
            text or XML editor. It contains meta data, a file list and database options.
        </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-name"></a><code class="literal">&lt;Name&gt;</code></h4></div></div></div><p>
                The package name (required).
            </p><p>
                </p><pre class="programlisting">
&lt;Name&gt;Calendar&lt;/Name&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-version"></a><code class="literal">&lt;Version&gt;</code></h4></div></div></div><p>
                The package version (required).
            </p><p>
                </p><pre class="programlisting">
&lt;Version&gt;1.2.3&lt;/Version&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-framework"></a><code class="literal">&lt;Framework&gt;</code></h4></div></div></div><p>
                The targeted framework version (3.2.x means e.g. 3.2.1 or 3.2.2) (required).
            </p><p>
                </p><pre class="programlisting">
&lt;Framework&gt;3.2.x&lt;/Framework&gt;
                </pre><p>
            </p><p>
                Can also be used several times.
            </p><p>
                </p><pre class="programlisting">
&lt;Framework&gt;3.0.x&lt;/Framework&gt;
&lt;Framework&gt;3.1.x&lt;/Framework&gt;
&lt;Framework&gt;3.2.x&lt;/Framework&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-vendor"></a><code class="literal">&lt;Vendor&gt;</code></h4></div></div></div><p>
                The package vendor (required).
            </p><p>
                </p><pre class="programlisting">
&lt;Vendor&gt;OTRS AG&lt;/Vendor&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-url"></a><code class="literal">&lt;URL&gt;</code></h4></div></div></div><p>
                The vendor URL (required).
            </p><p>
                </p><pre class="programlisting">
&lt;URL&gt;https://otrs.com/&lt;/URL&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-license"></a><code class="literal">&lt;License&gt;</code></h4></div></div></div><p>
                The license of the package (required).
            </p><p>
                </p><pre class="programlisting">
&lt;License&gt;GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007&lt;/License&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-changelog"></a><code class="literal">&lt;ChangeLog&gt;</code></h4></div></div></div><p>
                The package change log (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;ChangeLog Version="1.1.2" Date="2013-02-15 18:45:21"&gt;Added some feature.&lt;/ChangeLog&gt;
&lt;ChangeLog Version="1.1.1" Date="2013-02-15 16:17:51"&gt;New package.&lt;/ChangeLog&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-description"></a><code class="literal">&lt;Description&gt;</code></h4></div></div></div><p>
                The package description in different languages (required).
            </p><p>
                </p><pre class="programlisting">
&lt;Description Lang="en"&gt;A web calendar.&lt;/Description&gt;
&lt;Description Lang="de"&gt;Ein Web Kalender.&lt;/Description&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-possible-actions-installed"></a>Package Actions</h4></div></div></div><p>
                The possible actions for the package after installation. If one of these actions is
                not defined on the package, it will be considered as possible.
            </p><p>
                </p><pre class="programlisting">
&lt;PackageIsVisible&gt;1&lt;/PackageIsVisible&gt;
&lt;PackageIsDownloadable&gt;0&lt;/PackageIsDownloadable&gt;
&lt;PackageIsRemovable&gt;1&lt;/PackageIsRemovable&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-buildhost"></a><code class="literal">&lt;BuildHost&gt;</code></h4></div></div></div><p>
                This will be filled in automatically by OPM.
            </p><p>
                </p><pre class="programlisting">
&lt;BuildHost&gt;?&lt;/BuildHost&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-builddate"></a><code class="literal">&lt;BuildDate&gt;</code></h4></div></div></div><p>
                This will be filled in automatically by OPM.
            </p><p>
                </p><pre class="programlisting">
&lt;BuildDate&gt;?&lt;/BuildDate&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-package-required"></a><code class="literal">&lt;PackageRequired&gt;</code></h4></div></div></div><p>
                Packages that must be installed beforehand (optional). If <code class="literal">PackageRequired</code> is used,
                a version of the required package must be specified.
            </p><p>
                </p><pre class="programlisting">
&lt;PackageRequired Version="1.0.3"&gt;SomeOtherPackage&lt;/PackageRequired&gt;
&lt;PackageRequired Version="5.3.2"&gt;SomeotherPackage2&lt;/PackageRequired&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-module-required"></a><code class="literal">&lt;ModuleRequired&gt;</code></h4></div></div></div><p>
                Perl modules that must be installed beforehand (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;ModuleRequired Version="1.03"&gt;Encode&lt;/ModuleRequired&gt;
&lt;ModuleRequired Version="5.32"&gt;MIME::Tools&lt;/ModuleRequired&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-os"></a><code class="literal">&lt;OS&gt;</code></h4></div></div></div><p>
                Required OS (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;OS&gt;linux&lt;/OS&gt;
&lt;OS&gt;darwin&lt;/OS&gt;
&lt;OS&gt;mswin32&lt;/OS&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-filelist"></a><code class="literal">&lt;Filelist&gt;</code></h4></div></div></div><p>
                This is a list of files included in the package (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;Filelist&gt;
    &lt;File Permission="644" Location="Kernel/Config/Files/Calendar.pm"/&gt;
    &lt;File Permission="644" Location="Kernel/System/CalendarEvent.pm"/&gt;
    &lt;File Permission="644" Location="Kernel/Modules/AgentCalendar.pm"/&gt;
    &lt;File Permission="644" Location="Kernel/Language/de_AgentCalendar.pm"/&gt;
&lt;/Filelist&gt;
                </pre><p>
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-database-install"></a><code class="literal">&lt;DatabaseInstall&gt;</code></h4></div></div></div><p>
                Database entries that have to be created when a package is installed (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;DatabaseInstall&gt;
    &lt;TableCreate Name="calendar_event"&gt;
    &lt;Column Name="id" Required="true" PrimaryKey="true" AutoIncrement="true" Type="BIGINT"/&gt;
    &lt;Column Name="title" Required="true" Size="250" Type="VARCHAR"/&gt;
    &lt;Column Name="content" Required="false" Size="250" Type="VARCHAR"/&gt;
    &lt;Column Name="start_time" Required="true" Type="DATE"/&gt;
    &lt;Column Name="end_time" Required="true" Type="DATE"/&gt;
    &lt;Column Name="owner_id" Required="true" Type="INTEGER"/&gt;
    &lt;Column Name="event_status" Required="true" Size="50" Type="VARCHAR"/&gt;
    &lt;/TableCreate&gt;
&lt;/DatabaseInstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;DatabaseInstall Type="post"&gt;</code> or <code class="literal">&lt;DatabaseInstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-database-upgrade"></a><code class="literal">&lt;DatabaseUpgrade&gt;</code></h4></div></div></div><p>
                Information on which actions have to be performed in case of an upgrade (optional).
                Example if already installed package version is below 1.3.4 (e. g. 1.2.6), the
                defined action will be performed:
            </p><p>
                </p><pre class="programlisting">
&lt;DatabaseUpgrade&gt;
    &lt;TableCreate Name="calendar_event_involved" Version="1.3.4"&gt;
        &lt;Column Name="event_id" Required="true" Type="BIGINT"/&gt;
        &lt;Column Name="user_id" Required="true" Type="INTEGER"/&gt;
    &lt;/TableCreate&gt;
&lt;/DatabaseUpgrade&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;DatabaseUpgrade Type="post"&gt;</code> or <code class="literal">&lt;DatabaseUpgrade
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-database-reinstall"></a><code class="literal">&lt;DatabaseReinstall&gt;</code></h4></div></div></div><p>
                Information on which actions have to be performed if the package is reinstalled (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;DatabaseReinstall&gt;&lt;/DatabaseReinstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;DatabaseReinstall Type="post"&gt;</code> or <code class="literal">&lt;DatabaseReinstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-database-uninstall"></a><code class="literal">&lt;DatabaseUninstall&gt;</code></h4></div></div></div><p>
                Actions to be performed on package uninstall (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;DatabaseUninstall&gt;
    &lt;TableDrop Name="calendar_event" /&gt;
&lt;/DatabaseUninstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;DatabaseUninstall Type="post"&gt;</code> or <code class="literal">&lt;DatabaseUninstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-intro-install"></a><code class="literal">&lt;IntroInstall&gt;</code></h4></div></div></div><p>
                To show a "pre" or "post" install introduction in installation dialog.
            </p><p>
                </p><pre class="programlisting">
&lt;IntroInstall Type="post" Lang="en" Title="Some Title"&gt;&lt;![CDATA[
Some Info formatted in HTML....
]]&gt;&lt;/IntroInstall&gt;
                </pre><p>
            </p><p>
                You can also use the <code class="literal">Format</code> attribute to define if you want to use "html" (which
                is default) or "plain" to use automatically a <code class="literal">&lt;pre&gt;&lt;/pre&gt;</code> tag when
                intro is shown (to keep the newlines and whitespace of the content).
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-intro-uninstall"></a><code class="literal">&lt;IntroUninstall&gt;</code></h4></div></div></div><p>
                To show a "pre" or "post" uninstall introduction in uninstallation dialog.
            </p><p>
                </p><pre class="programlisting">
&lt;IntroUninstall Type="post" Lang="en" Title="Some Title"&gt;&lt;![CDATA[
Some Info formatted in html....
]]&gt;&lt;/IntroUninstall&gt;
                </pre><p>
            </p><p>
                You can also use the <code class="literal">Format</code> attribute to define if you want to use "html" (which
                is default) or "plain" to use automatically a <code class="literal">&lt;pre&gt;&lt;/pre&gt;</code> tag when
                intro is shown (to keep the newlines and whitespace of the content).
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-intro-reinstall"></a><code class="literal">&lt;IntroReinstall&gt;</code></h4></div></div></div><p>
                To show a "pre" or "post" reinstall introduction in re-installation dialog.
            </p><p>
                </p><pre class="programlisting">
&lt;IntroReinstall Type="post" Lang="en" Title="Some Title"&gt;&lt;![CDATA[
Some Info formatted in html....
]]&gt;&lt;/IntroReinstall&gt;
                </pre><p>
            </p><p>
                You can also use the <code class="literal">Format</code> attribute to define if you want to use "html" (which
                is default) or "plain" to use automatically a <code class="literal">&lt;pre&gt;&lt;/pre&gt;</code> tag when
                intro is shown (to keep the newlines and whitespace of the content).
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-intro-upgrade"></a><code class="literal">&lt;IntroUpgrade&gt;</code></h4></div></div></div><p>
                To show a "pre" or "post" upgrade introduction in upgrading dialog.
            </p><p>
                </p><pre class="programlisting">
&lt;IntroUpgrade Type="post" Lang="en" Title="Some Title"&gt;&lt;![CDATA[
Some Info formatted in html....
]]&gt;&lt;/IntroUpgrade&gt;
                </pre><p>
            </p><p>
                You can also use the <code class="literal">Format</code> attribute to define if you want to use "html" (which
                is default) or "plain" to use automatically a <code class="literal">&lt;pre&gt;&lt;/pre&gt;</code> tag when
                intro is shown (to keep the newlines and whitespace of the content).
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-code-install"></a><code class="literal">&lt;CodeInstall&gt;</code></h4></div></div></div><p>
                Perl code to be executed when the package is installed (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;CodeInstall&gt;&lt;![CDATA[
# log example
$Kernel::OM-&gt;Get('Kernel::System::Log')-&gt;Log(
    Priority =&gt; 'notice',
    Message =&gt; "Some Message!",
);
# database example
$Kernel::OM-&gt;Get('Kernel::System::DB')-&gt;Do(SQL =&gt; "SOME SQL");
]]&gt;&lt;/CodeInstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;CodeInstall Type="post"&gt;</code> or <code class="literal">&lt;CodeInstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-code-uninstall"></a><code class="literal">&lt;CodeUninstall&gt;</code></h4></div></div></div><p>
                Perl code to be executed when the package is uninstalled (optional). On "pre" or "post"
                time of package uninstallation.
            </p><p>
                </p><pre class="programlisting">
&lt;CodeUninstall&gt;&lt;![CDATA[
...
]]&gt;&lt;/CodeUninstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;CodeUninstall Type="post"&gt;</code> or <code class="literal">&lt;CodeUninstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-code-reinstall"></a><code class="literal">&lt;CodeReinstall&gt;</code></h4></div></div></div><p>
                Perl code to be executed when the package is reinstalled (optional).
            </p><p>
                </p><pre class="programlisting">
&lt;CodeReinstall&gt;&lt;![CDATA[
...
]]&gt;&lt;/CodeReinstall&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;CodeReinstall Type="post"&gt;</code> or <code class="literal">&lt;CodeReinstall
                Type="pre"&gt;</code> to define the time of execution separately (<code class="literal">post</code> is default). For
                more info see <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-code-upgrade"></a><code class="literal">&lt;CodeUpgrade&gt;</code></h4></div></div></div><p>
                Perl code to be executed when the package is upgraded (subject to <code class="literal">version</code> tag),
                (optional). Example if already installed package version is below 1.3.4 (e. g.
                1.2.6), defined action will be performed:
            </p><p>
                </p><pre class="programlisting">
&lt;CodeUpgrade Version="1.3.4"&gt;&lt;![CDATA[
...
]]&gt;&lt;/CodeUpgrade&gt;
                </pre><p>
            </p><p>
                You also can choose <code class="literal">&lt;CodeUpgrade Type="post"&gt;</code> or
                <code class="literal">&lt;CodeUpgrade Type="pre"&gt;</code> to define the time of execution
                separately (<code class="literal">post</code> is default). For more info see
                <a class="link" href="package-building.html#package-life-cycle" title="Package Life Cycle - Install/Upgrade/Uninstall">Package Life Cycle</a>.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-packagemerge"></a><code class="literal">&lt;PackageMerge&gt;</code></h4></div></div></div><p>
                This tag singals that a package has been merged into another package. In this case
                the original package needs to be removed from the file system and the packages database,
                but all data must be kept. Let's assume that <code class="literal">PackageOne</code> was merged
                into <code class="literal">PackageTwo</code>. Then <code class="filename">PackageTwo.sopm</code>
                should contain this:
            </p><p>
                </p><pre class="programlisting">
&lt;PackageMerge Name="MergeOne" TargetVersion="2.0.0"&gt;&lt;/PackageMerge&gt;
                </pre><p>
            </p><p>
                If <code class="literal">PackageOne</code> also contained database structures, we need to be
                sure that it was at the latest available version of the package to have a consistent
                state in the database after merging the package. The attribute <code class="literal">TargetVersion</code>
                does just this: it signifies the last known version of <code class="literal">PackageOne</code>
                at the time <code class="literal">PackageTwo</code> was created. This is mainly to stop the upgrade process
                if in the user's system a version of <code class="literal">PackageOne</code> was found that is
                <span class="emphasis"><em>newer</em></span> than the one specified in <code class="literal">TargetVersion</code> as this
                could lead to problems.
            </p><p>
                Additionally it is possible to add required database and code upgrade tags for
                <code class="literal">PackageOne</code> to make sure that it gets properly upgraded to the
                <code class="literal">TargetVersion</code> <span class="emphasis"><em>before</em></span> merging it - to avoid
                inconsistency problems. Here's how this could look like:
            </p><p>
                </p><pre class="programlisting">
&lt;PackageMerge Name="MergeOne" TargetVersion="2.0.0"&gt;
  &lt;DatabaseUpgrade Type="merge"&gt;
      &lt;TableCreate Name="merge_package"&gt;
          &lt;Column Name="id" Required="true" PrimaryKey="true" AutoIncrement="true" Type="INTEGER"/&gt;
          &lt;Column Name="description" Required="true" Size="200" Type="VARCHAR"/&gt;
      &lt;/TableCreate&gt;
  &lt;/DatabaseUpgrade&gt;
&lt;/PackageMerge&gt;
                </pre><p>
            </p><p>
                As you can see the attribute <code class="literal">Type="merge"</code> needs to be set in this case.
                These sections will only be executed if a package merge is possible.
            </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="package-conditions-ifpackage-ifnotpackage"></a>Conditions: <code class="literal">IfPackage</code> and <code class="literal">IfNotPackage</code></h4></div></div></div><p>
                These attributes can be added to the regular <code class="literal">Database*</code> and <code class="literal">Code*</code> sections.
                If they are present, the section will only be executed if another package is or is not
                in the local package repository.
            </p><p>
                </p><pre class="programlisting">
&lt;DatabaseInstall IfPackage="AnyPackage"&gt;
    ...
&lt;/DatabaseInstall&gt;
                </pre><p>
            </p><p>
                or
            </p><p>
                </p><pre class="programlisting">
&lt;CodeUpgrade IfNotPackage="OtherPackage"&gt;
    ...
&lt;/CodeUpgrade&gt;
                </pre><p>
            </p><p>
                These attributes can be also set in the <code class="literal">Database*</code> and <code class="literal">Code*</code> sections inside the
                <code class="literal">PackageMerge</code> tags.
            </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="package-example-sopm"></a>Example .sopm</h3></div></div></div><p>
            This is an example spec file looks with some of the above tags.
        </p><p>
            </p><pre class="programlisting">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;otrs_package version="1.0"&gt;
    &lt;Name&gt;Calendar&lt;/Name&gt;
    &lt;Version&gt;0.0.1&lt;/Version&gt;
    &lt;Framework&gt;3.2.x&lt;/Framework&gt;
    &lt;Vendor&gt;OTRS AG&lt;/Vendor&gt;
    &lt;URL&gt;https://otrs.com/&lt;/URL&gt;
    &lt;License&gt;GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007&lt;/License&gt;
    &lt;ChangeLog Version="1.1.2" Date="2013-02-15 18:45:21"&gt;Added some feature.&lt;/ChangeLog&gt;
    &lt;ChangeLog Version="1.1.1" Date="2013-02-15 16:17:51"&gt;New package.&lt;/ChangeLog&gt;
    &lt;Description Lang="en"&gt;A web calendar.&lt;/Description&gt;
    &lt;Description Lang="de"&gt;Ein Web Kalender.&lt;/Description&gt;
    &lt;IntroInstall Type="post" Lang="en" Title="Thank you!"&gt;Thank you for choosing the Calendar module.&lt;/IntroInstall&gt;
    &lt;IntroInstall Type="post" Lang="de" Title="Vielen Dank!"&gt;Vielen Dank fuer die Auswahl des Kalender Modules.&lt;/IntroInstall&gt;
    &lt;BuildDate&gt;?&lt;/BuildDate&gt;
    &lt;BuildHost&gt;?&lt;/BuildHost&gt;
    &lt;Filelist&gt;
        &lt;File Permission="644" Location="Kernel/Config/Files/Calendar.pm"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="Kernel/System/CalendarEvent.pm"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="Kernel/Modules/AgentCalendar.pm"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="Kernel/Language/de_AgentCalendar.pm"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="Kernel/Output/HTML/Standard/AgentCalendar.tt"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="Kernel/Output/HTML/NotificationCalendar.pm"&gt;&lt;/File&gt;
        &lt;File Permission="644" Location="var/httpd/htdocs/images/Standard/calendar.png"&gt;&lt;/File&gt;
    &lt;/Filelist&gt;
    &lt;DatabaseInstall&gt;
        &lt;TableCreate Name="calendar_event"&gt;
            &lt;Column Name="id" Required="true" PrimaryKey="true" AutoIncrement="true" Type="BIGINT"/&gt;
            &lt;Column Name="title" Required="true" Size="250" Type="VARCHAR"/&gt;
            &lt;Column Name="content" Required="false" Size="250" Type="VARCHAR"/&gt;
            &lt;Column Name="start_time" Required="true" Type="DATE"/&gt;
            &lt;Column Name="end_time" Required="true" Type="DATE"/&gt;
            &lt;Column Name="owner_id" Required="true" Type="INTEGER"/&gt;
            &lt;Column Name="event_status" Required="true" Size="50" Type="VARCHAR"/&gt;
        &lt;/TableCreate&gt;
    &lt;/DatabaseInstall&gt;
    &lt;DatabaseUninstall&gt;
        &lt;TableDrop Name="calendar_event"/&gt;
    &lt;/DatabaseUninstall&gt;
&lt;/otrs_package&gt;
            </pre><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="package-build"></a>Package Build</h3></div></div></div><p>
            To build an .opm package from the spec opm.
        </p><p>
            </p><pre class="screen">
shell&gt; bin/otrs.Console.pl Dev::Package::Build /path/to/example.sopm /tmp
Building package...
Done.
shell&gt;
            </pre><p>
        </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="package-life-cycle"></a>Package Life Cycle - Install/Upgrade/Uninstall</h3></div></div></div><p>
            The following image shows you how the life cycle of a package
            installation/upgrade/uninstallation works in the backend step by step.
        </p><p>
            </p><div class="figure"><a name="id-1.5.3.6.3.1"></a><p class="title"><b>Figure 4.1. Package Life Cycle</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/package-life-cycle.png" alt="Package Life Cycle"></div></div></div></div><p><br class="figure-break">
        </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="how-to-publish-extensions.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="how-to-publish-extensions.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="package-porting.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 4. How to Publish Your OTRS Extensions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Package Porting</td></tr></table></div></body></html>
